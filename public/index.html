<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BID달인 - 실시간 경매 플랫폼</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #000000;
            --primary-dark: #1a1a1a;
            --primary-light: #333333;
            --secondary: #ffffff;
            --accent: #3b82f6;
            --success: #22c55e;
            --danger: #ef4444;
            --warning: #f59e0b;
            --points: #f59e0b;
            --dark: #0a0a0a;
            --light: #fafafa;
            --gray: #71717a;
            --gray-light: #a1a1aa;
            --border: #e5e5e5;
            --gradient: linear-gradient(135deg, #000000 0%, #1a1a1a 100%);
            --gradient-subtle: linear-gradient(135deg, #1a1a1a 0%, #262626 100%);
            --card-shadow: 0 4px 20px rgba(0,0,0,0.08);
            --card-shadow-hover: 0 12px 40px rgba(0,0,0,0.15);
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #fafafa;
            min-height: 100vh;
            color: var(--dark);
        }

        /* 헤더 - 중고나라 스타일 */
        .header {
            background: white;
            color: #333;
            padding: 0 20px;
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom: 1px solid #e5e5e5;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 64px;
            gap: 40px;
        }

        .logo {
            font-size: 1.6rem;
            font-weight: 800;
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            color: #222;
            flex-shrink: 0;
        }

        .logo i {
            font-size: 1.8rem;
            color: #f59e0b;
        }

        /* 헤더 검색창 */
        .header-search {
            flex: 1;
            max-width: 500px;
        }

        .header-search-box {
            display: flex;
            align-items: center;
            background: #f5f5f5;
            border-radius: 8px;
            padding: 0 16px;
            height: 44px;
            border: 1px solid transparent;
            transition: all 0.2s;
        }

        .header-search-box:focus-within {
            background: white;
            border-color: #222;
        }

        .header-search-box input {
            flex: 1;
            border: none;
            background: transparent;
            font-size: 0.95rem;
            outline: none;
            color: #333;
        }

        .header-search-box input::placeholder {
            color: #999;
        }

        .header-search-box button {
            background: none;
            border: none;
            color: #666;
            cursor: pointer;
            font-size: 1.1rem;
            padding: 8px;
        }

        .header-search-box button:hover {
            color: #222;
        }

        .nav-links {
            display: flex;
            gap: 24px;
            flex-shrink: 0;
        }

        .nav-link {
            color: #666;
            text-decoration: none;
            font-weight: 500;
            font-size: 0.95rem;
            padding: 8px 0;
            border-radius: 0;
            transition: all 0.2s;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .nav-link:hover {
            color: #222;
        }

        .nav-link.active {
            color: #f59e0b;
        }

        .user-section {
            display: flex;
            align-items: center;
            gap: 16px;
            flex-shrink: 0;
        }

        .points-badge {
            background: #f59e0b;
            padding: 8px 14px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 6px;
            color: white;
            position: relative;
            cursor: pointer;
            transition: all 0.2s;
        }

        .points-badge:hover {
            background: #d97706;
        }

        .user-name {
            font-weight: 500;
            font-size: 0.9rem;
            color: #333;
        }

        /* 모바일 메뉴 버튼 */
        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            color: #333;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 8px;
        }

        /* 알림 */
        .notification-wrapper {
            position: relative;
        }

        .notification-btn {
            background: transparent;
            border: none;
            color: #666;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            position: relative;
            transition: all 0.2s;
            font-size: 1.1rem;
        }

        .notification-btn:hover {
            color: #333;
            background: #f5f5f5;
        }

        .notification-btn:hover {
            background: rgba(255,255,255,0.3);
        }

        .notification-badge {
            position: absolute;
            top: -2px;
            right: -2px;
            background: #ef4444;
            color: white;
            font-size: 0.7rem;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
        }

        .notification-dropdown {
            position: absolute;
            top: 50px;
            right: 0;
            width: 320px;
            background: white;
            border-radius: 4px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            z-index: 1001;
            overflow: hidden;
        }

        .notification-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px;
            border-bottom: 1px solid #e5e5e5;
            color: #1f2937;
            font-weight: 600;
        }

        .mark-read-btn {
            background: none;
            border: none;
            color: #3b82f6;
            font-size: 0.85rem;
            cursor: pointer;
        }

        .notification-list {
            max-height: 300px;
            overflow-y: auto;
        }

        .notification-item {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            padding: 12px 16px;
            border-bottom: 1px solid #f3f4f6;
            transition: background 0.2s;
        }

        .notification-item:hover {
            background: #f9fafb;
        }

        .notification-item.unread {
            background: #eff6ff;
        }

        .notification-icon {
            width: 36px;
            height: 36px;
            background: #e5e7eb;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #6b7280;
            flex-shrink: 0;
        }

        .notification-item.unread .notification-icon {
            background: #3b82f6;
            color: white;
        }

        .notification-content {
            flex: 1;
            min-width: 0;
        }

        .notification-message {
            color: #1f2937;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .notification-time {
            color: #9ca3af;
            font-size: 0.8rem;
            margin-top: 4px;
        }

        .notification-close {
            background: none;
            border: none;
            color: #9ca3af;
            cursor: pointer;
            padding: 4px;
        }

        .notification-close:hover {
            color: #ef4444;
        }

        .notification-empty {
            padding: 40px;
            text-align: center;
            color: #9ca3af;
        }

        .notification-empty i {
            font-size: 2rem;
            margin-bottom: 10px;
            display: block;
        }

        /* 반응형 - 모바일 */
        @media (max-width: 768px) {
            .mobile-menu-btn {
                display: block;
            }

            .nav-links {
                display: none;
                position: absolute;
                top: 70px;
                left: 0;
                right: 0;
                background: var(--primary-dark);
                flex-direction: column;
                padding: 20px;
                gap: 10px;
            }

            .nav-links.mobile-open {
                display: flex;
            }

            .nav-link {
                padding: 12px 16px;
            }

            .user-section {
                gap: 10px;
            }

            .user-name {
                display: none;
            }

            .notification-dropdown {
                width: 280px;
                right: -50px;
            }
        }

        .btn {
            padding: 10px 24px;
            border: none;
            border-radius: 4px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-size: 0.95rem;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .btn-secondary {
            background: white;
            color: var(--primary);
        }

        .btn-secondary:hover {
            background: var(--light);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-success:hover {
            background: #16a34a;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(34, 197, 94, 0.4);
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        .btn-outline {
            background: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
        }

        .btn-outline:hover {
            background: var(--primary);
            color: white;
        }

        .btn-lg {
            padding: 14px 32px;
            font-size: 1.1rem;
        }

        .btn-sm {
            padding: 6px 14px;
            font-size: 0.85rem;
        }

        /* 메인 컨테이너 */
        .main-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        /* 홈페이지 3단 레이아웃 */
        .home-layout {
            display: grid;
            grid-template-columns: 260px 1fr 280px;
            gap: 24px;
            max-width: 1600px;
            margin: 0 auto;
            padding: 24px 20px;
        }

        .home-main-content {
            min-width: 0;
        }

        /* 왼쪽 사이드바 - 필터 */
        .filter-sidebar {
            position: sticky;
            top: 94px;
            height: fit-content;
            max-height: calc(100vh - 114px);
            overflow-y: auto;
        }

        .sidebar-card {
            background: white;
            border-radius: 4px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.06);
            margin-bottom: 16px;
            overflow: hidden;
            border: 1px solid #e5e5e5;
        }

        .sidebar-card-header {
            padding: 16px 20px;
            font-weight: 700;
            font-size: 1rem;
            border-bottom: 1px solid #f0f0f0;
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--dark);
        }

        .sidebar-card-header i {
            color: var(--primary);
        }

        .sidebar-card-content {
            padding: 16px 20px;
        }

        .filter-list {
            list-style: none;
        }

        .filter-item {
            padding: 10px 12px;
            margin: 4px 0;
            border-radius: 2px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.2s;
            font-size: 0.95rem;
            color: #374151;
        }

        .filter-item:hover {
            background: #f5f5f5;
        }

        .filter-item.active {
            background: var(--primary);
            color: white;
        }

        .filter-item i {
            width: 20px;
            text-align: center;
            font-size: 0.9rem;
        }

        .filter-item .count {
            margin-left: auto;
            font-size: 0.8rem;
            background: #f0f0f0;
            padding: 2px 8px;
            border-radius: 4px;
            color: #6b7280;
        }

        .filter-item.active .count {
            background: rgba(255,255,255,0.2);
            color: white;
        }

        /* 가격 범위 필터 */
        .price-range-inputs {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 16px;
        }

        .price-input {
            flex: 1;
            padding: 10px 12px;
            border: 1px solid #e5e5e5;
            border-radius: 6px;
            font-size: 0.9rem;
            text-align: center;
        }

        .price-input:focus {
            outline: none;
            border-color: var(--primary);
        }

        .price-range-divider {
            color: #9ca3af;
            font-weight: 500;
        }

        .price-presets {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .price-preset {
            padding: 6px 12px;
            background: #f5f5f5;
            border: 1px solid #e5e5e5;
            border-radius: 6px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .price-preset:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .price-preset.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .apply-filter-btn {
            width: 100%;
            padding: 12px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 16px;
            transition: all 0.2s;
        }

        .apply-filter-btn:hover {
            background: var(--primary-dark);
        }

        /* 오른쪽 사이드바 - 현황 */
        .status-sidebar {
            position: sticky;
            top: 94px;
            height: fit-content;
            max-height: calc(100vh - 114px);
            overflow-y: auto;
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 0;
            border-bottom: 1px solid #f5f5f5;
        }

        .status-item:last-child {
            border-bottom: none;
        }

        .status-icon {
            width: 42px;
            height: 42px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
        }

        .status-icon.buy {
            background: #dcfce7;
            color: #16a34a;
        }

        .status-icon.sell {
            background: #dbeafe;
            color: #2563eb;
        }

        .status-icon.bid {
            background: #fef3c7;
            color: #d97706;
        }

        .status-icon.favorite {
            background: #fce7f3;
            color: #db2777;
        }

        .status-info {
            flex: 1;
            min-width: 0;
        }

        .status-label {
            font-size: 0.85rem;
            color: #6b7280;
        }

        .status-value {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--dark);
        }

        .status-change {
            font-size: 0.8rem;
            padding: 2px 8px;
            border-radius: 4px;
        }

        .status-change.up {
            background: #dcfce7;
            color: #16a34a;
        }

        .status-change.down {
            background: #fee2e2;
            color: #dc2626;
        }

        /* 최근 활동 */
        .activity-list {
            max-height: 300px;
            overflow-y: auto;
        }

        .activity-item {
            display: flex;
            gap: 12px;
            padding: 12px 0;
            border-bottom: 1px solid #f5f5f5;
        }

        .activity-item:last-child {
            border-bottom: none;
        }

        .activity-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: var(--gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.85rem;
            font-weight: 600;
            flex-shrink: 0;
        }

        .activity-content {
            flex: 1;
            min-width: 0;
        }

        .activity-text {
            font-size: 0.9rem;
            color: #374151;
            line-height: 1.4;
        }

        .activity-text strong {
            color: var(--primary);
        }

        .activity-time {
            font-size: 0.8rem;
            color: #9ca3af;
            margin-top: 4px;
        }

        /* 퀵 액션 버튼 */
        .quick-actions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .quick-action-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            padding: 16px 12px;
            background: #f9fafb;
            border: 1px solid #e5e5e5;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .quick-action-btn:hover {
            background: white;
            border-color: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .quick-action-btn i {
            font-size: 1.3rem;
            color: var(--primary);
        }

        .quick-action-btn span {
            font-size: 0.85rem;
            font-weight: 500;
            color: #374151;
        }

        /* 사이드바 반응형 */
        @media (max-width: 1200px) {
            .home-layout {
                grid-template-columns: 240px 1fr;
            }

            .status-sidebar {
                display: none;
            }
        }

        @media (max-width: 900px) {
            .home-layout {
                grid-template-columns: 1fr;
            }

            .filter-sidebar {
                display: none;
            }
        }

        /* 히어로 섹션 */
        .hero {
            background: var(--gradient);
            border-radius: 8px;
            padding: 60px 40px;
            color: white;
            margin-bottom: 40px;
            position: relative;
            overflow: hidden;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -20%;
            width: 600px;
            height: 600px;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
        }

        .hero-content {
            position: relative;
            z-index: 1;
        }

        .hero h1 {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        .hero p {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 30px;
        }

        .hero-stats {
            display: flex;
            gap: 40px;
            margin-top: 30px;
        }

        .hero-stat {
            text-align: center;
        }

        .hero-stat-value {
            font-size: 2.5rem;
            font-weight: 700;
        }

        .hero-stat-label {
            opacity: 0.8;
            font-size: 0.95rem;
        }

        /* 검색 및 필터 */
        .search-section {
            background: white;
            border-radius: 6px;
            padding: 24px;
            margin-bottom: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.05);
        }

        .search-bar {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

        .search-input-wrapper {
            flex: 1;
            position: relative;
        }

        .search-input-wrapper i {
            position: absolute;
            left: 16px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray);
        }

        .search-input {
            width: 100%;
            padding: 14px 14px 14px 48px;
            border: 2px solid #e5e7eb;
            border-radius: 4px;
            font-size: 1rem;
            transition: all 0.3s;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(0, 0, 0, 0.08);
        }

        .filter-chips {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .filter-chip {
            padding: 8px 18px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            background: white;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
        }

        .filter-chip:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .filter-chip.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        /* 경매 그리드 */
        .section-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-title i {
            color: var(--primary);
        }

        .auction-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
            margin-bottom: 40px;
        }

        @media (max-width: 1100px) {
            .auction-grid { grid-template-columns: repeat(3, 1fr); }
        }
        @media (max-width: 800px) {
            .auction-grid { grid-template-columns: repeat(2, 1fr); }
        }

        .auction-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid #eee;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .auction-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .auction-image {
            aspect-ratio: 1;
            background: #f5f5f5;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #bbb;
            font-size: 2.5rem;
            position: relative;
            overflow: hidden;
        }

        .auction-badge {
            position: absolute;
            top: 10px;
            left: 10px;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: 600;
        }

        .badge-hot {
            background: var(--danger);
            color: white;
        }

        .badge-ending {
            background: var(--warning);
            color: white;
        }

        .badge-new {
            background: var(--success);
            color: white;
        }

        .favorite-btn {
            position: absolute;
            bottom: 10px;
            right: 10px;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            color: #ccc;
        }

        .favorite-btn:hover {
            color: var(--danger);
        }

        .favorite-btn.active {
            background: white;
            color: var(--danger);
        }

        .auction-content {
            padding: 14px;
        }

        .auction-category {
            color: var(--gray);
            font-size: 0.75rem;
            font-weight: 500;
            margin-bottom: 4px;
        }

        .auction-title {
            font-size: 0.9rem;
            font-weight: 500;
            margin-bottom: 8px;
            color: var(--dark);
            line-height: 1.4;
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }

        .auction-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 6px;
        }

        .current-price {
            font-size: 1rem;
            font-weight: 700;
            color: var(--dark);
        }

        .bid-count {
            color: var(--gray);
            font-size: 0.75rem;
        }

        .time-left {
            display: flex;
            align-items: center;
            gap: 4px;
            color: var(--gray);
            font-weight: 500;
            font-size: 0.75rem;
        }

        .progress-bar {
            height: 4px;
            background: #e5e7eb;
            border-radius: 2px;
            overflow: hidden;
            margin-top: 10px;
        }

        .progress-fill {
            height: 100%;
            background: var(--gradient);
            border-radius: 2px;
            transition: width 0.3s;
        }

        /* 경매 상세 페이지 */
        .auction-detail {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 30px;
        }

        .auction-main {
            background: white;
            border-radius: 8px;
            padding: 0;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            border: 1px solid #e5e5e5;
        }

        /* 상품 브레드크럼 */
        .auction-breadcrumb {
            padding: 12px 20px;
            border-bottom: 1px solid #e5e5e5;
            font-size: 0.85rem;
            color: #6b7280;
        }

        .auction-breadcrumb a {
            color: #6b7280;
            text-decoration: none;
        }

        .auction-breadcrumb a:hover {
            color: #3b82f6;
        }

        .auction-breadcrumb span {
            margin: 0 8px;
            color: #d1d5db;
        }

        /* 상품 이미지 갤러리 - Kobay 스타일 */
        .auction-gallery-container {
            padding: 20px;
            display: flex;
            gap: 16px;
        }

        .auction-thumbnails {
            display: flex;
            flex-direction: column;
            gap: 8px;
            width: 80px;
        }

        .auction-thumbnail {
            width: 80px;
            height: 80px;
            border: 2px solid #e5e5e5;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f9fafb;
            cursor: pointer;
            font-size: 1.5rem;
            color: #9ca3af;
            transition: all 0.2s;
        }

        .auction-thumbnail:hover,
        .auction-thumbnail.active {
            border-color: #3b82f6;
        }

        .auction-thumbnail img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 6px;
        }

        .auction-main-image {
            flex: 1;
            height: 450px;
            background: #f9fafb;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
            border: 1px solid #e5e5e5;
        }

        .auction-main-image i {
            font-size: 8rem;
            color: #d1d5db;
        }

        .auction-main-image img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .image-zoom-btn {
            position: absolute;
            bottom: 12px;
            right: 12px;
            width: 40px;
            height: 40px;
            background: rgba(0,0,0,0.6);
            border: none;
            border-radius: 50%;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* 상품 정보 헤더 */
        .auction-info-header {
            padding: 20px;
            border-top: 1px solid #e5e5e5;
        }

        .auction-detail-title {
            font-size: 1.4rem;
            font-weight: 600;
            margin-bottom: 12px;
            color: #1f2937;
            line-height: 1.4;
        }

        .auction-meta {
            display: flex;
            align-items: center;
            gap: 16px;
            font-size: 0.9rem;
            color: #6b7280;
        }

        .auction-meta-item {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .auction-meta-item i {
            color: #9ca3af;
        }

        /* 탭 네비게이션 */
        .auction-tabs {
            display: flex;
            border-top: 1px solid #e5e5e5;
            border-bottom: 1px solid #e5e5e5;
        }

        .auction-tab {
            flex: 1;
            padding: 14px 20px;
            text-align: center;
            font-size: 0.95rem;
            color: #6b7280;
            background: #f9fafb;
            border: none;
            cursor: pointer;
            transition: all 0.2s;
            border-right: 1px solid #e5e5e5;
        }

        .auction-tab:last-child {
            border-right: none;
        }

        .auction-tab:hover {
            background: white;
        }

        .auction-tab.active {
            background: white;
            color: #1f2937;
            font-weight: 600;
            position: relative;
        }

        .auction-tab.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            right: 0;
            height: 2px;
            background: #3b82f6;
        }

        /* 상품 설명 섹션 */
        .auction-description-section {
            padding: 24px 20px;
        }

        .auction-description {
            color: #4b5563;
            line-height: 1.8;
            font-size: 0.95rem;
        }

        /* 판매자 정보 - Kobay 스타일 */
        .seller-info-section {
            padding: 20px;
            background: #f9fafb;
            border-top: 1px solid #e5e5e5;
        }

        .seller-info {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 0;
            background: transparent;
            border-radius: 0;
            margin-bottom: 0;
        }

        .seller-avatar {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 1.1rem;
        }

        .seller-details {
            flex: 1;
        }

        .seller-name {
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 4px;
        }

        .seller-rating {
            font-size: 0.85rem;
            color: #6b7280;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .seller-rating i {
            color: #fbbf24;
        }

        .seller-stats {
            display: flex;
            gap: 16px;
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid #e5e5e5;
        }

        .seller-stat {
            text-align: center;
            flex: 1;
        }

        .seller-stat-value {
            font-weight: 600;
            color: #1f2937;
            font-size: 1.1rem;
        }

        .seller-stat-label {
            font-size: 0.8rem;
            color: #6b7280;
            margin-top: 2px;
        }

        /* 입찰 패널 - Kobay 스타일 */
        .bid-panel {
            background: white;
            border-radius: 8px;
            padding: 0;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            position: sticky;
            top: 90px;
            border: 1px solid #e5e5e5;
        }

        .bid-panel-header {
            display: flex;
            justify-content: flex-end;
            gap: 8px;
            padding: 12px 16px;
            border-bottom: 1px solid #e5e5e5;
        }

        .bid-panel-header-btn {
            padding: 6px 14px;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            background: white;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .bid-panel-header-btn:hover {
            background: #f3f4f6;
        }

        .bid-panel-header-btn.primary {
            background: #374151;
            color: white;
            border-color: #374151;
        }

        .bid-status {
            padding: 20px 24px;
            border-bottom: 1px solid #e5e5e5;
        }

        .bid-status-row {
            display: flex;
            align-items: center;
            margin-bottom: 16px;
        }

        .bid-status-label {
            color: #6b7280;
            font-size: 0.9rem;
            min-width: 80px;
        }

        .bid-current-price {
            font-size: 2rem;
            font-weight: 700;
            color: #111;
        }

        .bid-info-grid {
            display: grid;
            grid-template-columns: 80px 1fr;
            gap: 12px 0;
            font-size: 0.9rem;
        }

        .bid-info-label {
            color: #6b7280;
        }

        .bid-info-value {
            color: #111;
            font-weight: 500;
        }

        .bid-info-value.time {
            color: #111;
            font-weight: 600;
        }

        .bid-info-value .date {
            display: block;
            font-size: 0.8rem;
            color: #9ca3af;
            font-weight: 400;
        }

        .bid-input-section {
            padding: 20px 24px;
            border-bottom: 1px solid #e5e5e5;
        }

        .bid-input-row {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 16px;
        }

        .bid-input-row .bid-info-label {
            min-width: 80px;
        }

        .bid-input-wrapper {
            display: flex;
            align-items: center;
            gap: 10px;
            flex: 1;
            justify-content: flex-end;
        }

        .bid-adjust-btn {
            width: 38px;
            height: 38px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            background: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.4rem;
            font-weight: 600;
            color: #374151;
            transition: all 0.15s;
        }

        .bid-adjust-btn:hover {
            background: #f3f4f6;
            border-color: #9ca3af;
        }

        .bid-input {
            width: 150px;
            padding: 10px 14px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 1.15rem;
            font-weight: 600;
            text-align: right;
        }

        .bid-input:focus {
            outline: none;
            border-color: #111;
        }

        .bid-input-unit {
            font-size: 1rem;
            font-weight: 500;
            color: #374151;
            min-width: 24px;
        }

        .bid-expected {
            display: flex;
            align-items: center;
            margin-bottom: 16px;
        }

        .bid-expected .bid-info-label {
            min-width: 80px;
        }

        .bid-expected-value {
            font-weight: 700;
            color: #111;
        }

        .bid-expected-detail {
            font-size: 0.8rem;
            color: #9ca3af;
            margin-left: 8px;
        }

        .bid-buttons {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .bid-btn {
            width: 100%;
            padding: 14px;
            border: none;
            border-radius: 4px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .bid-btn-primary {
            background: #111;
            color: white;
        }

        .bid-btn-primary:hover {
            background: #333;
        }

        .bid-btn-secondary {
            background: #6b7280;
            color: white;
        }

        .bid-btn-secondary:hover {
            background: #4b5563;
        }

        .bid-btn-outline {
            background: white;
            color: #111;
            border: 1px solid #d1d5db;
        }

        .bid-btn-outline:hover {
            background: #f3f4f6;
        }

        .bid-btn-outline.favorite-active {
            background: #fef2f2;
            border-color: #ef4444;
            color: #ef4444;
        }

        .bid-btn-outline.favorite-active:hover {
            background: #fee2e2;
        }

        .bid-sub-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 10px;
        }

        /* 판매자 정보 섹션 */
        .seller-section {
            padding: 20px 24px;
            border-bottom: 1px solid #e5e5e5;
        }

        .seller-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 16px;
        }

        .seller-info-box {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .seller-name {
            font-weight: 600;
            color: #111;
        }

        .seller-badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 2px 8px;
            background: #dbeafe;
            color: #1d4ed8;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .seller-stats {
            display: flex;
            gap: 16px;
            color: #6b7280;
            font-size: 0.85rem;
        }

        .seller-action-buttons {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }

        .seller-action-btn {
            padding: 10px;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            background: white;
            font-size: 0.85rem;
            cursor: pointer;
            text-align: center;
        }

        .seller-action-btn:hover {
            background: #f3f4f6;
        }

        /* 입찰 내역 */
        .bid-history {
            padding: 20px 24px;
            max-height: 300px;
            overflow-y: auto;
        }

        .bid-history-title {
            font-weight: 700;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.95rem;
        }

        .bid-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #f3f4f6;
        }

        .bid-item:last-child {
            border-bottom: none;
        }

        .bid-item.highlight {
            background: #fef3c7;
            margin: 0 -24px;
            padding: 10px 24px;
        }

        .bidder-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .bidder-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: #e5e7eb;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #6b7280;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .bid-amount {
            font-weight: 600;
            color: #111;
        }

        .bid-time {
            font-size: 0.75rem;
            color: #9ca3af;
        }

        /* 실시간 알림 */
        .live-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--danger);
            font-weight: 600;
            padding: 12px 24px;
            background: #fef2f2;
            border-bottom: 1px solid #fecaca;
        }

        .live-dot {
            width: 8px;
            height: 8px;
            background: var(--danger);
            border-radius: 50%;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(1.2); }
        }

        .viewer-count {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--gray);
            font-size: 0.85rem;
        }

        /* 포인트 표시 */
        .bid-panel-points {
            padding: 16px 24px;
            background: #f9fafb;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .panel-points-label {
            color: #6b7280;
            font-size: 0.9rem;
        }

        .panel-points-value {
            font-weight: 700;
            color: #111;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .panel-points-value i {
            color: #f59e0b;
        }

        /* 1:1 채팅 */
        .chat-fab {
            position: fixed;
            bottom: 24px;
            right: 24px;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #f59e0b, #ef4444);
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(245, 158, 11, 0.4);
            z-index: 1500;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .chat-fab:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 30px rgba(245, 158, 11, 0.5);
        }

        .chat-fab .badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #ef4444;
            color: white;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            font-size: 0.75rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            border: 2px solid white;
        }

        .chat-window {
            position: fixed;
            bottom: 100px;
            right: 24px;
            width: 380px;
            height: 500px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 50px rgba(0,0,0,0.2);
            z-index: 1500;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            animation: chatSlide 0.3s ease;
        }

        @keyframes chatSlide {
            from {
                opacity: 0;
                transform: translateY(20px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .chat-header {
            background: linear-gradient(135deg, #000, #1a1a1a);
            color: white;
            padding: 16px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chat-header-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
        }

        .chat-header-title .online-dot {
            width: 8px;
            height: 8px;
            background: #22c55e;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .chat-close {
            background: none;
            border: none;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            opacity: 0.7;
            transition: opacity 0.2s;
        }

        .chat-close:hover {
            opacity: 1;
        }

        .chat-list {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
            background: #f9fafb;
        }

        .chat-room-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: white;
            border-radius: 8px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.2s;
            border: 1px solid #e5e5e5;
        }

        .chat-room-item:hover {
            border-color: #f59e0b;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .chat-room-item.unread {
            background: #fef3c7;
            border-color: #f59e0b;
        }

        .chat-room-avatar {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, #000, #333);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
        }

        .chat-room-info {
            flex: 1;
            min-width: 0;
        }

        .chat-room-name {
            font-weight: 600;
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .chat-room-preview {
            font-size: 0.85rem;
            color: #6b7280;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .chat-room-time {
            font-size: 0.75rem;
            color: #9ca3af;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
            background: #f9fafb;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .chat-message {
            max-width: 80%;
            padding: 10px 14px;
            border-radius: 12px;
            font-size: 0.95rem;
            line-height: 1.4;
        }

        .chat-message.sent {
            align-self: flex-end;
            background: linear-gradient(135deg, #000, #1a1a1a);
            color: white;
            border-bottom-right-radius: 4px;
        }

        .chat-message.received {
            align-self: flex-start;
            background: white;
            border: 1px solid #e5e5e5;
            border-bottom-left-radius: 4px;
        }

        .chat-message-time {
            font-size: 0.7rem;
            opacity: 0.6;
            margin-top: 4px;
        }

        .chat-input-area {
            padding: 12px 16px;
            background: white;
            border-top: 1px solid #e5e5e5;
            display: flex;
            gap: 10px;
        }

        .chat-input {
            flex: 1;
            padding: 10px 14px;
            border: 1px solid #e5e5e5;
            border-radius: 20px;
            font-size: 0.95rem;
            outline: none;
            transition: border-color 0.2s;
        }

        .chat-input:focus {
            border-color: #f59e0b;
        }

        .chat-send-btn {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #f59e0b, #ef4444);
            border: none;
            border-radius: 50%;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s;
        }

        .chat-send-btn:hover {
            transform: scale(1.1);
        }

        .chat-typing {
            font-size: 0.8rem;
            color: #6b7280;
            font-style: italic;
            padding: 0 16px 8px;
        }

        .chat-back-btn {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 1rem;
            margin-right: 8px;
        }

        .chat-empty {
            text-align: center;
            padding: 40px;
            color: #9ca3af;
        }

        .chat-empty i {
            font-size: 3rem;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        @media (max-width: 480px) {
            .chat-window {
                width: calc(100vw - 20px);
                right: 10px;
                bottom: 80px;
                height: 60vh;
            }
        }

        /* 모달 */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.6);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            backdrop-filter: blur(4px);
        }

        .modal {
            background: white;
            border-radius: 8px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            animation: modalSlide 0.3s ease;
        }

        @keyframes modalSlide {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .modal-close {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background: var(--light);
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.3s;
        }

        .modal-close:hover {
            background: var(--danger);
            color: white;
        }

        .modal-content {
            background: white;
            border-radius: 6px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            animation: modalSlide 0.3s ease;
        }

        .modal-content .modal-header {
            padding: 20px 24px;
            border-bottom: 1px solid #e5e5e5;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0;
        }

        .modal-content .modal-header h3 {
            margin: 0;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .modal-content .modal-body {
            padding: 24px;
        }

        .modal-content .modal-footer {
            padding: 16px 24px;
            border-top: 1px solid #e5e5e5;
            display: flex;
            justify-content: flex-end;
            gap: 12px;
        }

        /* 문의하기 모달 */
        .seller-inquiry-info {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 16px;
            background: #f9fafb;
            border-radius: 4px;
            margin-bottom: 16px;
        }

        .inquiry-quick-btns {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin-bottom: 16px;
        }

        .quick-btn {
            padding: 8px 14px;
            border: 1px solid #e5e5e5;
            border-radius: 8px;
            background: white;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .quick-btn:hover {
            background: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }

        /* 신용도 모달 */
        .credit-profile {
            text-align: center;
            padding: 20px 0;
        }

        .credit-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2rem;
            font-weight: 700;
            margin: 0 auto 12px;
        }

        .credit-name {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .credit-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            background: #dcfce7;
            color: #16a34a;
            border-radius: 8px;
            font-size: 0.85rem;
            font-weight: 500;
        }

        .credit-score-section {
            text-align: center;
            padding: 24px;
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border-radius: 6px;
            margin: 16px 0;
        }

        .credit-score-circle {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin: 0 auto 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .credit-score-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: #f59e0b;
            line-height: 1;
        }

        .credit-score-label {
            font-size: 0.8rem;
            color: #6b7280;
        }

        .credit-grade {
            font-size: 1.1rem;
            font-weight: 600;
            color: #b45309;
        }

        .credit-stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin: 16px 0;
        }

        .credit-stat-item {
            text-align: center;
            padding: 16px;
            background: #f9fafb;
            border-radius: 4px;
        }

        .credit-stat-value {
            font-size: 1.2rem;
            font-weight: 700;
            color: #1f2937;
        }

        .credit-stat-label {
            font-size: 0.8rem;
            color: #6b7280;
            margin-top: 4px;
        }

        .credit-reviews {
            margin-top: 16px;
        }

        .credit-review-title {
            font-weight: 600;
            margin-bottom: 12px;
        }

        .credit-review-item {
            padding: 12px;
            background: #f9fafb;
            border-radius: 8px;
            margin-bottom: 8px;
        }

        .review-stars {
            font-size: 0.9rem;
            margin-bottom: 4px;
        }

        .review-text {
            font-size: 0.9rem;
            color: #374151;
        }

        .review-date {
            font-size: 0.8rem;
            color: #9ca3af;
            margin-top: 4px;
        }

        /* 즐겨찾기 활성화 버튼 */
        .seller-action-btn.active {
            background: #fef3c7;
            border-color: #f59e0b;
            color: #b45309;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
        }

        .form-input {
            width: 100%;
            padding: 14px 18px;
            border: 2px solid #e5e7eb;
            border-radius: 4px;
            font-size: 1rem;
            transition: all 0.3s;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(0, 0, 0, 0.08);
        }

        .form-textarea {
            min-height: 120px;
            resize: vertical;
        }

        .form-select {
            width: 100%;
            padding: 14px 18px;
            border: 2px solid #e5e7eb;
            border-radius: 4px;
            font-size: 1rem;
            background: white;
            cursor: pointer;
        }

        /* 토스트 알림 */
        .toast-container {
            position: fixed;
            top: 90px;
            right: 20px;
            z-index: 3000;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .toast {
            background: white;
            padding: 16px 24px;
            border-radius: 4px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.15);
            display: flex;
            align-items: center;
            gap: 12px;
            animation: toastSlide 0.3s ease;
            min-width: 300px;
        }

        @keyframes toastSlide {
            from {
                opacity: 0;
                transform: translateX(100%);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .toast-success {
            border-left: 4px solid var(--success);
        }

        .toast-error {
            border-left: 4px solid var(--danger);
        }

        .toast-info {
            border-left: 4px solid var(--primary);
        }

        .toast-icon {
            font-size: 1.3rem;
        }

        .toast-success .toast-icon { color: var(--success); }
        .toast-error .toast-icon { color: var(--danger); }
        .toast-info .toast-icon { color: var(--primary); }

        /* 마이페이지 */
        .profile-header {
            background: var(--gradient);
            border-radius: 8px;
            padding: 40px;
            color: white;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            gap: 30px;
        }

        .profile-avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            color: var(--primary);
            font-weight: 700;
        }

        .profile-info h2 {
            font-size: 1.8rem;
            margin-bottom: 8px;
        }

        .profile-stats {
            display: flex;
            gap: 30px;
            margin-top: 15px;
        }

        .profile-stat {
            text-align: center;
        }

        .profile-stat-value {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .profile-stat-label {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid #e5e7eb;
            padding-bottom: 10px;
        }

        .tab {
            padding: 10px 24px;
            border: none;
            background: none;
            font-size: 1rem;
            font-weight: 600;
            color: var(--gray);
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.3s;
        }

        .tab:hover {
            background: var(--light);
        }

        .tab.active {
            color: var(--primary);
            background: rgba(0, 0, 0, 0.08);
        }

        /* 포인트 관련 스타일 */
        .points-summary {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            border-radius: 6px;
            padding: 24px;
            margin-bottom: 24px;
        }

        .points-balance {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .points-icon {
            width: 60px;
            height: 60px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            color: #f59e0b;
        }

        .points-info {
            flex: 1;
        }

        .points-label {
            color: rgba(255,255,255,0.9);
            font-size: 0.9rem;
        }

        .points-value {
            font-size: 2rem;
            font-weight: 700;
            color: white;
        }

        .points-history-title {
            font-weight: 600;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .points-history-list {
            background: #f9fafb;
            border-radius: 4px;
        }

        .points-history-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px;
            border-bottom: 1px solid #e5e5e5;
        }

        .points-history-item:last-child {
            border-bottom: none;
        }

        .points-history-reason {
            font-weight: 500;
        }

        .points-history-date {
            font-size: 0.85rem;
            color: #6b7280;
            margin-top: 4px;
        }

        .points-history-amount {
            font-weight: 700;
            font-size: 1.1rem;
        }

        .points-history-amount.plus {
            color: #10b981;
        }

        .points-history-amount.minus {
            color: #ef4444;
        }

        /* 충전 모달 */
        .charge-current {
            text-align: center;
            padding: 16px;
            background: #f9fafb;
            border-radius: 4px;
            margin-bottom: 20px;
            font-size: 1.1rem;
        }

        .charge-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }

        .charge-option {
            padding: 16px;
            border: 2px solid #e5e5e5;
            border-radius: 4px;
            background: white;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .charge-option:hover {
            border-color: #3b82f6;
        }

        .charge-option.active {
            border-color: #3b82f6;
            background: #eff6ff;
            color: #3b82f6;
        }

        .charge-custom {
            margin-bottom: 20px;
        }

        .charge-custom label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .charge-result {
            text-align: center;
            padding: 16px;
            background: #dcfce7;
            border-radius: 4px;
            color: #166534;
            font-size: 1.1rem;
        }

        /* 로딩 */
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 60px;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid var(--light);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* 빈 상태 */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--gray);
        }

        .empty-state i {
            font-size: 4rem;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .empty-state h3 {
            font-size: 1.3rem;
            margin-bottom: 10px;
            color: var(--dark);
        }

        /* 입찰 성공 애니메이션 */
        .bid-success-animation {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 40px 60px;
            border-radius: 8px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            text-align: center;
            z-index: 4000;
            animation: bidSuccess 0.5s ease;
        }

        @keyframes bidSuccess {
            0% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.5);
            }
            50% {
                transform: translate(-50%, -50%) scale(1.1);
            }
            100% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
        }

        .bid-success-icon {
            font-size: 4rem;
            color: var(--success);
            margin-bottom: 15px;
        }

        .bid-success-text {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--dark);
        }

        /* 반응형 */
        @media (max-width: 1024px) {
            .auction-detail {
                grid-template-columns: 1fr;
            }

            .bid-panel {
                position: static;
            }
        }

        @media (max-width: 768px) {
            .header-content {
                flex-wrap: wrap;
                height: auto;
                padding: 15px 0;
            }

            .nav-links {
                width: 100%;
                justify-content: center;
                order: 3;
                margin-top: 15px;
                gap: 15px;
            }

            .hero h1 {
                font-size: 2rem;
            }

            .hero-stats {
                gap: 20px;
            }

            .auction-grid {
                grid-template-columns: 1fr;
            }
        }

        /* 새 입찰 알림 하이라이트 */
        .new-bid-highlight {
            animation: newBidPulse 1s ease;
        }

        @keyframes newBidPulse {
            0%, 100% {
                background: rgba(0, 0, 0, 0.05);
            }
            50% {
                background: rgba(0, 0, 0, 0.15);
            }
        }

        /* AI 추천 박스 */
        .ai-recommendation {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border-radius: 6px;
            padding: 20px;
            margin: 20px 0;
        }

        .ai-recommendation-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 12px;
            font-weight: 700;
            color: var(--dark);
        }

        .ai-recommendation-content {
            background: white;
            border-radius: 4px;
            padding: 15px;
        }

        .ai-strategy {
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 8px;
        }

        .ai-price {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--points);
        }

        .ai-tip {
            font-size: 0.9rem;
            color: var(--gray);
            margin-top: 8px;
        }

        /* =========================================
           향상된 경매 경험 - 새로운 스타일
           ========================================= */

        /* 포인트 변화 애니메이션 */
        .points-change-indicator {
            position: absolute;
            top: -8px;
            right: -8px;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 700;
            animation: pointsChangeFloat 1.5s ease forwards;
            pointer-events: none;
        }

        .points-change-indicator.negative {
            background: var(--danger);
            color: white;
        }

        .points-change-indicator.positive {
            background: var(--success);
            color: white;
        }

        @keyframes pointsChangeFloat {
            0% {
                opacity: 1;
                transform: translateY(0);
            }
            100% {
                opacity: 0;
                transform: translateY(-20px);
            }
        }

        /* 포인트 부족 흔들림 효과 */
        .shake-animation {
            animation: shake 0.5s ease;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20%, 60% { transform: translateX(-8px); }
            40%, 80% { transform: translateX(8px); }
        }

        /* 입찰 패널 포인트 표시 */
        .bid-panel-points {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border-radius: 4px;
            padding: 16px;
            margin: 15px 0;
            text-align: center;
        }

        .panel-points-label {
            font-size: 0.85rem;
            color: var(--dark);
            opacity: 0.7;
            margin-bottom: 4px;
        }

        .panel-points-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--dark);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .panel-points-value i {
            color: var(--points);
        }

        .insufficient-warning {
            color: var(--danger);
            font-size: 0.85rem;
            margin-top: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }

        /* Confetti 애니메이션 */
        .confetti-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 6000;
            overflow: hidden;
        }

        .confetti {
            position: absolute;
            top: -20px;
            animation: confettiFall 3s ease-out forwards;
        }

        @keyframes confettiFall {
            0% {
                transform: translateY(0) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }

        /* 새 입찰 슬라이드 + 글로우 효과 */
        .bid-item.new-bid-glow {
            animation: bidSlideIn 0.5s ease, bidGlow 1.5s ease;
        }

        @keyframes bidSlideIn {
            from {
                transform: translateX(-30px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes bidGlow {
            0% {
                box-shadow: 0 0 0 0 rgba(0, 0, 0, 0.4);
            }
            50% {
                box-shadow: 0 0 20px 5px rgba(0, 0, 0, 0.15);
            }
            100% {
                box-shadow: 0 0 0 0 transparent;
            }
        }

        /* 타이머 긴급도 상태 */
        .timer-box.urgent-warning {
            background: var(--warning) !important;
            animation: timerPulse 1s infinite;
        }

        .timer-box.urgent-danger {
            background: var(--danger) !important;
            animation: timerPulseFast 0.5s infinite;
        }

        @keyframes timerPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes timerPulseFast {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.08); }
        }

        /* 실시간 입찰 인디케이터 */
        .bidding-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: rgba(239, 68, 68, 0.1);
            border-radius: 8px;
            font-size: 0.85rem;
            color: var(--danger);
            animation: biddingPulse 1.5s infinite;
            margin-bottom: 15px;
        }

        @keyframes biddingPulse {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 1; }
        }

        /* =========================================
           튜토리얼 가이드 스타일
           ========================================= */

        .tutorial-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 5000;
            animation: tutorialFadeIn 0.3s ease;
        }

        @keyframes tutorialFadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .tutorial-spotlight {
            position: absolute;
            border-radius: 4px;
            box-shadow: 0 0 0 9999px rgba(0, 0, 0, 0.8);
            background: transparent;
            transition: all 0.4s ease;
            pointer-events: none;
        }

        .tutorial-tooltip {
            position: fixed;
            background: white;
            border-radius: 8px;
            padding: 24px;
            max-width: 340px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: tutorialSlide 0.4s ease;
            z-index: 5001;
        }

        @keyframes tutorialSlide {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .tutorial-progress {
            display: flex;
            gap: 6px;
            margin-bottom: 16px;
        }

        .tutorial-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--border);
            transition: all 0.3s;
        }

        .tutorial-dot.active {
            background: var(--primary);
            width: 24px;
            border-radius: 4px;
        }

        .tutorial-dot.completed {
            background: var(--success);
        }

        .tutorial-step-indicator {
            font-size: 0.85rem;
            color: var(--gray);
            margin-bottom: 8px;
        }

        .tutorial-title {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--primary);
        }

        .tutorial-description {
            color: var(--gray);
            line-height: 1.7;
            margin-bottom: 24px;
            font-size: 0.95rem;
        }

        .tutorial-buttons {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
        }

        .tutorial-character {
            text-align: center;
            margin-bottom: 20px;
        }

        .tutorial-character i {
            font-size: 3rem;
            color: var(--primary);
            animation: characterBounce 2s ease infinite;
        }

        @keyframes characterBounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-8px); }
        }

        /* =========================================
           이미지 업로드 영역 스타일
           ========================================= */

        .image-upload-area {
            border: 2px dashed var(--border);
            border-radius: 6px;
            padding: 40px;
            text-align: center;
            position: relative;
            transition: all 0.3s;
            background: var(--light);
        }

        .image-upload-area:hover {
            border-color: var(--primary);
            background: white;
        }

        .image-upload-area.dragover {
            border-color: var(--primary);
            background: rgba(0, 0, 0, 0.02);
        }

        .upload-placeholder {
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 12px;
            color: var(--gray);
        }

        .upload-placeholder i {
            font-size: 3rem;
            color: var(--gray-light);
        }

        .upload-placeholder span {
            font-size: 0.95rem;
        }

        .image-preview-container {
            position: relative;
            display: inline-block;
        }

        .image-preview-container img {
            max-width: 100%;
            max-height: 300px;
            border-radius: 4px;
            object-fit: cover;
        }

        .image-preview-remove {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            border: none;
            background: var(--danger);
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .image-preview-remove:hover {
            transform: scale(1.1);
        }

        .analyzing-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.95);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 12px;
            border-radius: 6px;
        }

        .analyzing-overlay i {
            font-size: 2.5rem;
            color: var(--primary);
        }

        .analyzing-overlay span {
            font-weight: 600;
            color: var(--dark);
        }

        .ai-analysis-result {
            margin-top: 20px;
            padding: 20px;
            background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
            border-radius: 4px;
            border: 1px solid var(--success);
        }

        .ai-analysis-result h4 {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--success);
            margin-bottom: 12px;
        }

        .ai-analysis-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(34, 197, 94, 0.2);
        }

        .ai-analysis-item:last-child {
            border-bottom: none;
        }

        .ai-analysis-label {
            color: var(--gray);
            font-size: 0.9rem;
        }

        .ai-analysis-value {
            font-weight: 600;
            color: var(--dark);
        }

        /* 향상된 입찰 성공 모달 */
        .bid-success-animation {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 50px 70px;
            border-radius: 8px;
            box-shadow: 0 25px 80px rgba(0,0,0,0.35);
            text-align: center;
            z-index: 4000;
            animation: bidSuccessBounce 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        @keyframes bidSuccessBounce {
            0% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.3);
            }
            50% {
                transform: translate(-50%, -50%) scale(1.05);
            }
            70% {
                transform: translate(-50%, -50%) scale(0.95);
            }
            100% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
        }

        .bid-success-icon {
            font-size: 5rem;
            color: var(--success);
            margin-bottom: 20px;
            animation: successPop 0.5s ease 0.3s both;
        }

        @keyframes successPop {
            0% { transform: scale(0); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        .bid-success-text {
            font-size: 1.6rem;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 8px;
        }

        .bid-success-amount {
            font-size: 1.2rem;
            color: var(--success);
            font-weight: 600;
        }

        /* =========================================
           실시간 채팅 스타일
           ========================================= */

        .chat-container {
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            margin-top: 20px;
            overflow: hidden;
        }

        .chat-header {
            background: var(--gradient);
            color: white;
            padding: 16px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .chat-header h3 {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1rem;
            font-weight: 600;
        }

        .chat-online-count {
            background: rgba(255,255,255,0.2);
            padding: 4px 12px;
            border-radius: 8px;
            font-size: 0.85rem;
        }

        .chat-messages {
            height: 300px;
            overflow-y: auto;
            padding: 16px;
            display: flex;
            flex-direction: column;
            gap: 12px;
            background: #fafafa;
        }

        .chat-message {
            display: flex;
            gap: 10px;
            animation: chatSlideIn 0.3s ease;
        }

        @keyframes chatSlideIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .chat-messages .chat-message.own {
            flex-direction: row-reverse !important;
            justify-content: flex-start !important;
        }

        .chat-messages .chat-message.own .chat-bubble {
            margin-right: 0;
            margin-left: 0;
            background: var(--primary) !important;
            color: white !important;
        }

        .chat-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: var(--gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 0.85rem;
            flex-shrink: 0;
        }

        .chat-message.own .chat-avatar {
            background: var(--success);
        }

        .chat-bubble {
            background: white;
            padding: 10px 14px;
            border-radius: 6px;
            border-top-left-radius: 4px;
            max-width: 70%;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .chat-message.own .chat-bubble {
            background: var(--primary);
            color: white;
            border-radius: 6px;
            border-top-right-radius: 4px;
        }

        .chat-nickname {
            font-size: 0.75rem;
            color: var(--gray);
            margin-bottom: 4px;
            font-weight: 600;
        }

        .chat-message.own .chat-nickname {
            color: rgba(255,255,255,0.8);
            text-align: right;
        }

        .chat-text {
            font-size: 0.9rem;
            line-height: 1.4;
            word-break: break-word;
        }

        .chat-time {
            font-size: 0.7rem;
            color: var(--gray-light);
            margin-top: 4px;
        }

        .chat-message.own .chat-time {
            color: rgba(255,255,255,0.6);
            text-align: right;
        }

        .chat-input-area {
            padding: 16px;
            border-top: 1px solid var(--border);
            display: flex;
            gap: 10px;
            background: white;
        }

        .chat-input {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 0.9rem;
            transition: all 0.3s;
        }

        .chat-input:focus {
            outline: none;
            border-color: var(--primary);
        }

        .chat-send-btn {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .chat-send-btn:hover {
            transform: scale(1.1);
            background: var(--primary-dark);
        }

        .chat-reactions {
            padding: 8px 16px;
            display: flex;
            gap: 8px;
            border-top: 1px solid var(--border);
            background: #fafafa;
        }

        .reaction-btn {
            padding: 6px 12px;
            border: none;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .reaction-btn:hover {
            transform: scale(1.2);
        }

        .chat-system-message {
            text-align: center;
            padding: 8px;
            color: var(--gray);
            font-size: 0.85rem;
        }

        .chat-system-message i {
            margin-right: 6px;
        }

        .chat-typing {
            padding: 8px 16px;
            font-size: 0.85rem;
            color: var(--gray);
            font-style: italic;
        }

        .reaction-float {
            position: fixed;
            font-size: 2rem;
            animation: reactionFloat 2s ease forwards;
            pointer-events: none;
            z-index: 1000;
        }

        @keyframes reactionFloat {
            0% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
            100% {
                opacity: 0;
                transform: translateY(-100px) scale(1.5);
            }
        }

        /* =========================================
           향상된 UI - 더 화려한 디자인
           ========================================= */

        /* 그라데이션 텍스트 */
        .gradient-text {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* 글로우 효과 버튼 */
        .btn-glow {
            position: relative;
            overflow: hidden;
        }

        .btn-glow::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                90deg,
                transparent,
                rgba(255,255,255,0.3),
                transparent
            );
            animation: btnGlow 2s infinite;
        }

        @keyframes btnGlow {
            0% { left: -100%; }
            50%, 100% { left: 100%; }
        }

        /* 펄스 뱃지 */
        .badge-pulse {
            position: relative;
        }

        .badge-pulse::after {
            content: '';
            position: absolute;
            top: -2px;
            right: -2px;
            width: 8px;
            height: 8px;
            background: var(--danger);
            border-radius: 50%;
            animation: badgePulse 1.5s infinite;
        }

        @keyframes badgePulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.5); opacity: 0.5; }
        }

        /* 카드 호버 효과 강화 */
        .auction-card {
            position: relative;
            overflow: hidden;
        }

        .auction-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(
                135deg,
                rgba(255,255,255,0) 0%,
                rgba(255,255,255,0.1) 50%,
                rgba(255,255,255,0) 100%
            );
            transform: translateX(-100%);
            transition: transform 0.6s;
            z-index: 1;
            pointer-events: none;
        }

        .auction-card:hover::before {
            transform: translateX(100%);
        }

        /* 가격 카운터 애니메이션 */
        .price-counter {
            display: inline-block;
            transition: all 0.3s;
        }

        .price-counter.updating {
            animation: priceUpdate 0.5s ease;
        }

        @keyframes priceUpdate {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); color: var(--success); }
        }

        /* 실시간 상태 표시 */
        .live-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
            border-radius: 8px;
            font-size: 0.85rem;
            font-weight: 600;
            animation: livePulse 2s infinite;
        }

        @keyframes livePulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); }
            50% { box-shadow: 0 0 0 10px rgba(239, 68, 68, 0); }
        }

        /* 참여자 아바타 스택 */
        .avatar-stack {
            display: flex;
        }

        .avatar-stack .avatar-item {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            border: 2px solid white;
            margin-left: -10px;
            background: var(--gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .avatar-stack .avatar-item:first-child {
            margin-left: 0;
        }

        .avatar-stack .avatar-more {
            background: var(--gray);
        }

        /* 히어로 섹션 파티클 효과 */
        .hero {
            position: relative;
        }

        .hero-particles {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            overflow: hidden;
            pointer-events: none;
        }

        .particle {
            position: absolute;
            width: 10px;
            height: 10px;
            background: rgba(255,255,255,0.3);
            border-radius: 50%;
            animation: particleFloat 10s infinite;
        }

        @keyframes particleFloat {
            0%, 100% {
                transform: translateY(0) translateX(0);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-400px) translateX(100px);
                opacity: 0;
            }
        }

        /* 스켈레톤 로딩 */
        .skeleton {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: skeletonLoading 1.5s infinite;
            border-radius: 8px;
        }

        @keyframes skeletonLoading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        /* 입찰 액션 버튼 강화 */
        .bid-action-btn {
            position: relative;
            background: linear-gradient(135deg, #000 0%, #333 100%);
            overflow: hidden;
        }

        .bid-action-btn::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .bid-action-btn:active::after {
            width: 300px;
            height: 300px;
        }

        /* 알림 뱃지 */
        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            min-width: 20px;
            height: 20px;
            background: var(--danger);
            color: white;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 6px;
            animation: notificationPop 0.3s ease;
        }

        @keyframes notificationPop {
            0% { transform: scale(0); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, createContext, useContext } = React;

        // API 베이스 URL (로컬: localhost, 배포: 현재 호스트)
        const API_BASE = window.location.hostname === 'localhost'
            ? 'http://localhost:3000'
            : window.location.origin;

        // Context
        const AuthContext = createContext(null);
        const ToastContext = createContext(null);

        // Toast Provider
        function ToastProvider({ children }) {
            const [toasts, setToasts] = useState([]);

            const addToast = (message, type = 'info') => {
                const id = Date.now();
                setToasts(prev => [...prev, { id, message, type }]);
                setTimeout(() => {
                    setToasts(prev => prev.filter(t => t.id !== id));
                }, 3000);
            };

            return (
                <ToastContext.Provider value={{ addToast }}>
                    {children}
                    <div className="toast-container">
                        {toasts.map(toast => (
                            <div key={toast.id} className={`toast toast-${toast.type}`}>
                                <i className={`toast-icon fas ${
                                    toast.type === 'success' ? 'fa-check-circle' :
                                    toast.type === 'error' ? 'fa-exclamation-circle' :
                                    'fa-info-circle'
                                }`}></i>
                                <span>{toast.message}</span>
                            </div>
                        ))}
                    </div>
                </ToastContext.Provider>
            );
        }

        // Confetti 효과 컴포넌트
        function ConfettiEffect() {
            const colors = ['#ef4444', '#22c55e', '#3b82f6', '#f59e0b', '#8b5cf6', '#ec4899'];
            const confetti = Array.from({ length: 50 }, (_, i) => ({
                id: i,
                left: Math.random() * 100,
                delay: Math.random() * 0.5,
                color: colors[Math.floor(Math.random() * colors.length)],
                size: Math.random() * 10 + 5,
                isCircle: Math.random() > 0.5
            }));

            return (
                <div className="confetti-container">
                    {confetti.map(c => (
                        <div
                            key={c.id}
                            className="confetti"
                            style={{
                                left: `${c.left}%`,
                                animationDelay: `${c.delay}s`,
                                background: c.color,
                                width: c.size,
                                height: c.size,
                                borderRadius: c.isCircle ? '50%' : '0'
                            }}
                        />
                    ))}
                </div>
            );
        }

        // 튜토리얼 가이드 컴포넌트
        function AuctionTutorial({ onComplete }) {
            const [currentStep, setCurrentStep] = useState(0);

            const tutorialSteps = [
                {
                    title: '현재가 확인하기',
                    description: '이 금액이 현재 최고 입찰 금액입니다. 입찰하려면 이 금액보다 높은 금액을 제시해야 합니다.',
                    icon: 'fa-won-sign'
                },
                {
                    title: '남은 시간 확인',
                    description: '경매 종료까지 남은 시간입니다. 시간이 끝나면 최고 입찰자가 낙찰됩니다. 마감이 임박하면 색상이 변합니다!',
                    icon: 'fa-clock'
                },
                {
                    title: '입찰 금액 입력',
                    description: '원하는 입찰 금액을 직접 입력하세요. 현재가보다 높은 금액을 입력해야 합니다.',
                    icon: 'fa-keyboard'
                },
                {
                    title: '빠른 입찰 버튼',
                    description: '+1천, +5천, +1만 버튼을 누르면 현재가에서 해당 금액만큼 추가된 금액으로 빠르게 입찰할 수 있습니다.',
                    icon: 'fa-bolt'
                },
                {
                    title: '입찰 내역',
                    description: '다른 참여자들의 입찰 내역을 실시간으로 확인할 수 있습니다. 새로운 입찰이 들어오면 알림이 표시됩니다.',
                    icon: 'fa-history'
                },
                {
                    title: '포인트 관리',
                    description: '상단에서 보유 포인트를 확인하세요. 입찰 시 포인트가 사용되며, 낙찰되지 않으면 반환됩니다.',
                    icon: 'fa-coins'
                }
            ];

            const handleNext = () => {
                if (currentStep < tutorialSteps.length - 1) {
                    setCurrentStep(currentStep + 1);
                } else {
                    handleComplete();
                }
            };

            const handleSkip = () => {
                handleComplete();
            };

            const handleComplete = () => {
                localStorage.setItem('auctionTutorialCompleted', 'true');
                if (onComplete) onComplete();
            };

            const step = tutorialSteps[currentStep];

            return (
                <div className="tutorial-overlay">
                    <div className="tutorial-tooltip" style={{ top: '50%', left: '50%', transform: 'translate(-50%, -50%)' }}>
                        <div className="tutorial-character">
                            <i className={`fas ${step.icon}`}></i>
                        </div>
                        <div className="tutorial-progress">
                            {tutorialSteps.map((_, idx) => (
                                <span
                                    key={idx}
                                    className={`tutorial-dot ${idx === currentStep ? 'active' : ''} ${idx < currentStep ? 'completed' : ''}`}
                                />
                            ))}
                        </div>
                        <div className="tutorial-step-indicator">
                            {currentStep + 1} / {tutorialSteps.length}
                        </div>
                        <h3 className="tutorial-title">{step.title}</h3>
                        <p className="tutorial-description">{step.description}</p>
                        <div className="tutorial-buttons">
                            <button className="btn btn-outline btn-sm" onClick={handleSkip}>
                                건너뛰기
                            </button>
                            <button className="btn btn-primary btn-sm" onClick={handleNext}>
                                {currentStep < tutorialSteps.length - 1 ? '다음' : '완료'}
                            </button>
                        </div>
                    </div>
                </div>
            );
        }

        // Auth Provider
        function AuthProvider({ children }) {
            const [user, setUser] = useState(null);
            const [token, setToken] = useState(localStorage.getItem('token'));
            const [points, setPoints] = useState(100000);

            useEffect(() => {
                if (token) {
                    // 토큰이 있으면 사용자 정보 로드
                    const savedUser = localStorage.getItem('user');
                    if (savedUser) {
                        setUser(JSON.parse(savedUser));
                    }

                    // 데모 토큰인 경우 10만 포인트
                    if (token === 'demo-token-12345') {
                        setPoints(100000);
                    } else {
                        // 일반 토큰인 경우 서버에서 포인트 조회
                        fetch(`${API_BASE}/users/points`, {
                            headers: { Authorization: `Bearer ${token}` }
                        })
                        .then(res => res.json())
                        .then(data => {
                            if (data.total !== undefined) {
                                setPoints(data.total);
                            }
                        })
                        .catch(err => console.log('포인트 로드 실패:', err));
                    }
                }
            }, [token]);

            const login = async (email, password) => {
                try {
                    const res = await fetch(`${API_BASE}/users/login`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ email, password })
                    });
                    const data = await res.json();
                    if (res.ok) {
                        setToken(data.token);
                        setUser(data.user);
                        localStorage.setItem('token', data.token);
                        localStorage.setItem('user', JSON.stringify(data.user));

                        // 로그인 후 포인트 조회
                        try {
                            const pointsRes = await fetch(`${API_BASE}/users/points`, {
                                headers: { Authorization: `Bearer ${data.token}` }
                            });
                            const pointsData = await pointsRes.json();
                            if (pointsRes.ok) {
                                setPoints(pointsData.total || 0);
                            }
                        } catch (e) {
                            console.log('포인트 조회 실패:', e);
                        }

                        return { success: true };
                    }
                    return { success: false, message: data.message };
                } catch (err) {
                    return { success: false, message: '서버 연결 실패' };
                }
            };

            const signup = async (email, password, name, nickname) => {
                try {
                    const res = await fetch(`${API_BASE}/users/signup`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ email, password, name, nickname })
                    });
                    const data = await res.json();
                    if (res.ok) {
                        return { success: true };
                    }
                    return { success: false, message: data.message };
                } catch (err) {
                    return { success: false, message: '서버 연결 실패' };
                }
            };

            const logout = () => {
                setToken(null);
                setUser(null);
                localStorage.removeItem('token');
                localStorage.removeItem('user');
            };

            // 데모용 로그인
            const demoLogin = () => {
                const demoUser = { id: 1, name: '테스트유저', nickname: '입찰왕', email: 'demo@test.com' };
                const demoToken = 'demo-token-12345';
                setToken(demoToken);
                setUser(demoUser);
                setPoints(100000); // 데모 계정은 10만 포인트
                localStorage.setItem('token', demoToken);
                localStorage.setItem('user', JSON.stringify(demoUser));
            };

            return (
                <AuthContext.Provider value={{ user, token, points, setPoints, login, signup, logout, demoLogin }}>
                    {children}
                </AuthContext.Provider>
            );
        }

        // 헤더 컴포넌트
        function Header({ currentPage, setCurrentPage, setGlobalSearchKeyword }) {
            const { user, points, logout, demoLogin } = useContext(AuthContext);
            const { addToast } = useContext(ToastContext);
            const [notifications, setNotifications] = useState([
                { id: 1, type: 'bid', message: '포켓몬 카드 10장에 새 입찰이 있습니다', time: '방금 전', read: false },
                { id: 2, type: 'win', message: '볼펜 세트 낙찰을 축하합니다!', time: '5분 전', read: false },
            ]);
            const [showNotifications, setShowNotifications] = useState(false);
            const [showMobileMenu, setShowMobileMenu] = useState(false);
            const [searchKeyword, setSearchKeyword] = useState('');

            const unreadCount = notifications.filter(n => !n.read).length;

            const markAllRead = () => {
                setNotifications(notifications.map(n => ({ ...n, read: true })));
            };

            const clearNotification = (id) => {
                setNotifications(notifications.filter(n => n.id !== id));
            };

            const handleSearch = (e) => {
                e.preventDefault();
                if (searchKeyword.trim()) {
                    if (setGlobalSearchKeyword) {
                        setGlobalSearchKeyword(searchKeyword.trim());
                    }
                    setCurrentPage('auctions');
                }
            };

            return (
                <header className="header">
                    <div className="header-content">
                        <div className="logo" onClick={() => setCurrentPage('home')}>
                            <div style={{
                                background: 'linear-gradient(135deg, #f59e0b, #ef4444)',
                                padding: '8px 10px',
                                borderRadius: '6px',
                                display: 'flex',
                                alignItems: 'center',
                                justifyContent: 'center'
                            }}>
                                <i className="fas fa-gavel" style={{fontSize: '1.2rem', color: 'white'}}></i>
                            </div>
                            <span style={{fontWeight: 800, fontSize: '1.4rem'}}>
                                <span style={{color: '#f59e0b'}}>BID</span>달인
                            </span>
                        </div>

                        {/* 검색창 */}
                        <div className="header-search">
                            <form onSubmit={handleSearch} className="header-search-box">
                                <input
                                    type="text"
                                    placeholder="어떤 상품을 찾으시나요?"
                                    value={searchKeyword}
                                    onChange={(e) => setSearchKeyword(e.target.value)}
                                />
                                <button type="submit">
                                    <i className="fas fa-search"></i>
                                </button>
                            </form>
                        </div>

                        {/* 모바일 메뉴 버튼 */}
                        <button className="mobile-menu-btn" onClick={() => setShowMobileMenu(!showMobileMenu)}>
                            <i className={`fas ${showMobileMenu ? 'fa-times' : 'fa-bars'}`}></i>
                        </button>

                        <nav className={`nav-links ${showMobileMenu ? 'mobile-open' : ''}`}>
                            {user && (
                                <span
                                    className={`nav-link ${currentPage === 'create' ? 'active' : ''}`}
                                    onClick={() => { setCurrentPage('create'); setShowMobileMenu(false); }}
                                >
                                    <i className="fas fa-plus-circle"></i> 판매하기
                                </span>
                            )}
                            <span
                                className={`nav-link ${currentPage === 'auctions' ? 'active' : ''}`}
                                onClick={() => { setCurrentPage('auctions'); setShowMobileMenu(false); }}
                            >
                                <i className="fas fa-store"></i> 경매목록
                            </span>
                            {user && (
                                <span
                                    className={`nav-link ${currentPage === 'mypage' ? 'active' : ''}`}
                                    onClick={() => { setCurrentPage('mypage'); setShowMobileMenu(false); }}
                                >
                                    <i className="fas fa-user"></i> 마이
                                </span>
                            )}
                        </nav>

                        <div className="user-section">
                            {user ? (
                                <>
                                    {/* 알림 벨 */}
                                    <div className="notification-wrapper">
                                        <button className="notification-btn" onClick={() => setShowNotifications(!showNotifications)}>
                                            <i className="fas fa-bell"></i>
                                            {unreadCount > 0 && <span className="notification-badge">{unreadCount}</span>}
                                        </button>

                                        {showNotifications && (
                                            <div className="notification-dropdown">
                                                <div className="notification-header">
                                                    <span>알림</span>
                                                    {unreadCount > 0 && (
                                                        <button className="mark-read-btn" onClick={markAllRead}>모두 읽음</button>
                                                    )}
                                                </div>
                                                <div className="notification-list">
                                                    {notifications.length > 0 ? notifications.map(n => (
                                                        <div key={n.id} className={`notification-item ${!n.read ? 'unread' : ''}`}>
                                                            <div className="notification-icon">
                                                                <i className={`fas ${n.type === 'bid' ? 'fa-gavel' : n.type === 'win' ? 'fa-trophy' : 'fa-info-circle'}`}></i>
                                                            </div>
                                                            <div className="notification-content">
                                                                <div className="notification-message">{n.message}</div>
                                                                <div className="notification-time">{n.time}</div>
                                                            </div>
                                                            <button className="notification-close" onClick={() => clearNotification(n.id)}>
                                                                <i className="fas fa-times"></i>
                                                            </button>
                                                        </div>
                                                    )) : (
                                                        <div className="notification-empty">
                                                            <i className="fas fa-bell-slash"></i>
                                                            <span>새 알림이 없습니다</span>
                                                        </div>
                                                    )}
                                                </div>
                                            </div>
                                        )}
                                    </div>

                                    <div className="points-badge" onClick={() => setCurrentPage('mypage')}>
                                        <i className="fas fa-coins"></i>
                                        {points.toLocaleString()}P
                                    </div>
                                    <span className="user-name">{user.nickname || user.name}님</span>
                                    <button className="btn btn-secondary btn-sm" onClick={() => { logout(); addToast('로그아웃 되었습니다', 'info'); }}>
                                        로그아웃
                                    </button>
                                </>
                            ) : (
                                <>
                                    <button className="btn btn-secondary btn-sm" onClick={() => setCurrentPage('login')}>
                                        로그인
                                    </button>
                                    <button className="btn btn-primary btn-sm" onClick={() => { demoLogin(); addToast('데모 계정으로 로그인 되었습니다!', 'success'); }}>
                                        데모 로그인
                                    </button>
                                </>
                            )}
                        </div>
                    </div>
                </header>
            );
        }

        // 홈 페이지
        function HomePage({ setCurrentPage, setSelectedAuction, setFilterCategory, setFilterPrice }) {
            const [auctions, setAuctions] = useState([]);
            const [popularAuctions, setPopularAuctions] = useState([]);
            const [endingSoonAuctions, setEndingSoonAuctions] = useState([]);
            const [loading, setLoading] = useState(true);
            const [stats, setStats] = useState({ total: 0, active: 0, bids: 0 });
            const [selectedCategory, setSelectedCategory] = useState('전체');
            const [priceRange, setPriceRange] = useState({ min: '', max: '' });
            const [userStats, setUserStats] = useState({ purchases: 0, sales: 0, bids: 0, favorites: 0 });
            const [recentActivities, setRecentActivities] = useState([]);
            const [favoriteIds, setFavoriteIds] = useState([]);

            const categories = [
                { name: '전체', icon: 'fa-th-large', count: 0 },
                { name: '전자기기', icon: 'fa-laptop', count: 0 },
                { name: '게임', icon: 'fa-gamepad', count: 0 },
                { name: '가전', icon: 'fa-blender', count: 0 },
                { name: '스포츠', icon: 'fa-futbol', count: 0 },
                { name: '도서', icon: 'fa-book', count: 0 },
                { name: '패션', icon: 'fa-tshirt', count: 0 },
                { name: '기타', icon: 'fa-box', count: 0 }
            ];

            const pricePresets = [
                { label: '~1만원', min: 0, max: 10000 },
                { label: '1~5만원', min: 10000, max: 50000 },
                { label: '5~10만원', min: 50000, max: 100000 },
                { label: '10~50만원', min: 100000, max: 500000 },
                { label: '50만원~', min: 500000, max: '' }
            ];

            useEffect(() => {
                loadData();
                loadUserStats();
            }, []);

            const loadData = async () => {
                setLoading(true);
                try {
                    const [allRes, popularRes, endingRes] = await Promise.all([
                        fetch(`${API_BASE}/auctions?status=진행중`),
                        fetch(`${API_BASE}/auctions/popular?limit=4`),
                        fetch(`${API_BASE}/auctions/ending-soon?limit=4`)
                    ]);

                    const allData = await allRes.json();
                    const popularData = await popularRes.json();
                    const endingData = await endingRes.json();

                    setAuctions(allData.auctions || []);
                    setPopularAuctions(popularData || []);
                    setEndingSoonAuctions(endingData || []);

                    // 카테고리별 개수 계산
                    const allAuctions = allData.auctions || [];
                    categories[0].count = allAuctions.length;
                    categories.forEach((cat, idx) => {
                        if (idx > 0) {
                            cat.count = allAuctions.filter(a => a.category === cat.name).length;
                        }
                    });

                    setStats({
                        total: allAuctions.length,
                        active: allAuctions.filter(a => a.status === '진행중').length,
                        bids: allAuctions.reduce((sum, a) => sum + (a.bid_count || 0), 0)
                    });
                } catch (err) {
                    console.error('데이터 로드 실패:', err);
                    const demoAuctions = [
                        { id: 1, title: 'iPhone 14 Pro 256GB', category: '전자기기', current_price: 850000, bid_count: 15, remaining_seconds: 3600, status: '진행중' },
                        { id: 2, title: '맥북 프로 M2 14인치', category: '전자기기', current_price: 1650000, bid_count: 23, remaining_seconds: 7200, status: '진행중' },
                        { id: 3, title: '에어팟 프로 2세대', category: '전자기기', current_price: 220000, bid_count: 8, remaining_seconds: 1800, status: '진행중' },
                        { id: 4, title: '닌텐도 스위치 OLED', category: '게임', current_price: 320000, bid_count: 12, remaining_seconds: 5400, status: '진행중' },
                    ];
                    setAuctions(demoAuctions);
                    setPopularAuctions(demoAuctions.slice(0, 4));
                    setEndingSoonAuctions(demoAuctions.filter(a => a.remaining_seconds < 5000).slice(0, 4));
                    setStats({ total: 4, active: 4, bids: 58 });
                }
                setLoading(false);
            };

            const loadUserStats = async () => {
                try {
                    const token = localStorage.getItem('token') || 'demo-token';
                    const [bidsRes, favoritesRes] = await Promise.all([
                        fetch(`${API_BASE}/auctions/bid/my`, { headers: { Authorization: `Bearer ${token}` }}),
                        fetch(`${API_BASE}/auctions/favorite/my`, { headers: { Authorization: `Bearer ${token}` }})
                    ]);

                    const bidsData = await bidsRes.json();
                    const favoritesData = await favoritesRes.json();

                    // 찜 ID 목록 저장 (AuctionCard에 전달용)
                    const favorites = favoritesData.favorites || [];
                    setFavoriteIds(favorites.map(f => f.id));

                    setUserStats({
                        purchases: 3,
                        sales: 2,
                        bids: Array.isArray(bidsData) ? bidsData.length : 5,
                        favorites: favorites.length
                    });

                    // 최근 활동 데모 데이터
                    setRecentActivities([
                        { id: 1, user: '김**', action: '입찰', item: 'iPhone 14 Pro', price: 850000, time: '방금 전' },
                        { id: 2, user: '이**', action: '낙찰', item: '맥북 프로 M2', price: 1650000, time: '5분 전' },
                        { id: 3, user: '박**', action: '등록', item: '에어팟 프로', price: 200000, time: '10분 전' },
                        { id: 4, user: '최**', action: '입찰', item: '닌텐도 스위치', price: 320000, time: '15분 전' },
                    ]);
                } catch (err) {
                    setUserStats({ purchases: 3, sales: 2, bids: 5, favorites: 8 });
                    setRecentActivities([
                        { id: 1, user: '김**', action: '입찰', item: 'iPhone 14 Pro', price: 850000, time: '방금 전' },
                        { id: 2, user: '이**', action: '낙찰', item: '맥북 프로 M2', price: 1650000, time: '5분 전' },
                    ]);
                }
            };

            const handleAuctionClick = (auction) => {
                setSelectedAuction(auction);
                setCurrentPage('detail');
            };

            const handleCategoryFilter = (category) => {
                setSelectedCategory(category);
                setFilterCategory(category);
                setFilterPrice({ min: '', max: '' });
                setCurrentPage('auctions');
            };

            const handlePricePreset = (preset) => {
                setPriceRange({ min: preset.min, max: preset.max });
            };

            const applyFilters = () => {
                setFilterCategory(selectedCategory);
                setFilterPrice(priceRange);
                setCurrentPage('auctions');
            };

            const particles = Array.from({ length: 20 }, (_, i) => ({
                id: i,
                left: Math.random() * 100,
                top: Math.random() * 100,
                delay: Math.random() * 5,
                size: Math.random() * 8 + 4
            }));

            return (
                <div className="home-layout">
                    {/* 왼쪽 사이드바 - 필터 */}
                    <aside className="filter-sidebar">
                        <div className="sidebar-card">
                            <div className="sidebar-card-header">
                                <i className="fas fa-filter"></i>
                                카테고리
                            </div>
                            <div className="sidebar-card-content" style={{padding: '8px 12px'}}>
                                <ul className="filter-list">
                                    {categories.map(cat => (
                                        <li
                                            key={cat.name}
                                            className={`filter-item ${selectedCategory === cat.name ? 'active' : ''}`}
                                            onClick={() => handleCategoryFilter(cat.name)}
                                        >
                                            <i className={`fas ${cat.icon}`}></i>
                                            {cat.name}
                                            <span className="count">{cat.count}</span>
                                        </li>
                                    ))}
                                </ul>
                            </div>
                        </div>

                        <div className="sidebar-card">
                            <div className="sidebar-card-header">
                                <i className="fas fa-won-sign"></i>
                                가격대
                            </div>
                            <div className="sidebar-card-content">
                                <div className="price-range-inputs">
                                    <input
                                        type="number"
                                        className="price-input"
                                        placeholder="최소"
                                        value={priceRange.min}
                                        onChange={(e) => setPriceRange({...priceRange, min: e.target.value})}
                                    />
                                    <span className="price-range-divider">~</span>
                                    <input
                                        type="number"
                                        className="price-input"
                                        placeholder="최대"
                                        value={priceRange.max}
                                        onChange={(e) => setPriceRange({...priceRange, max: e.target.value})}
                                    />
                                </div>
                                <div className="price-presets">
                                    {pricePresets.map((preset, idx) => (
                                        <button
                                            key={idx}
                                            className={`price-preset ${priceRange.min === preset.min && priceRange.max === preset.max ? 'active' : ''}`}
                                            onClick={() => handlePricePreset(preset)}
                                        >
                                            {preset.label}
                                        </button>
                                    ))}
                                </div>
                                <button className="apply-filter-btn" onClick={applyFilters}>
                                    <i className="fas fa-search"></i> 필터 적용
                                </button>
                            </div>
                        </div>

                        <div className="sidebar-card">
                            <div className="sidebar-card-header">
                                <i className="fas fa-bolt"></i>
                                빠른 메뉴
                            </div>
                            <div className="sidebar-card-content">
                                <div className="quick-actions">
                                    <button className="quick-action-btn" onClick={() => setCurrentPage('create')}>
                                        <i className="fas fa-plus-circle"></i>
                                        <span>경매 등록</span>
                                    </button>
                                    <button className="quick-action-btn" onClick={() => setCurrentPage('mypage')}>
                                        <i className="fas fa-user"></i>
                                        <span>마이페이지</span>
                                    </button>
                                    <button className="quick-action-btn" onClick={() => setCurrentPage('auctions')}>
                                        <i className="fas fa-gavel"></i>
                                        <span>전체 경매</span>
                                    </button>
                                    <button className="quick-action-btn" onClick={() => setCurrentPage('mypage')}>
                                        <i className="fas fa-heart"></i>
                                        <span>찜 목록</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </aside>

                    {/* 메인 콘텐츠 */}
                    <main className="home-main-content">
                        {/* 히어로 섹션 */}
                        <div className="hero">
                            <div className="hero-particles">
                                {particles.map(p => (
                                    <div
                                        key={p.id}
                                        className="particle"
                                        style={{
                                            left: `${p.left}%`,
                                            top: `${p.top}%`,
                                            animationDelay: `${p.delay}s`,
                                            width: p.size,
                                            height: p.size
                                        }}
                                    />
                                ))}
                            </div>
                            <div className="hero-content">
                                <div className="live-badge" style={{marginBottom: 20, display: 'inline-flex'}}>
                                    <span style={{width: 8, height: 8, background: 'white', borderRadius: '50%', animation: 'pulse 1.5s infinite'}}></span>
                                    LIVE 경매 진행중
                                </div>
                                <h1 style={{fontSize: '2.8rem', marginBottom: 20}}>
                                    실시간 경매의<br/>
                                    <span style={{background: 'linear-gradient(90deg, #fbbf24, #f59e0b)', WebkitBackgroundClip: 'text', WebkitTextFillColor: 'transparent'}}>새로운 경험</span>
                                </h1>
                                <p style={{fontSize: '1.1rem', opacity: 0.9, marginBottom: 25}}>
                                    BID달인에서 원하는 상품을 실시간으로 입찰하세요!
                                </p>
                                <div style={{display: 'flex', gap: 12}}>
                                    <button className="btn btn-secondary btn-glow" onClick={() => setCurrentPage('auctions')}>
                                        <i className="fas fa-search"></i> 경매 둘러보기
                                    </button>
                                    <button className="btn btn-outline" style={{borderColor: 'white', color: 'white'}} onClick={() => setCurrentPage('create')}>
                                        <i className="fas fa-plus"></i> 경매 등록
                                    </button>
                                </div>
                                <div className="hero-stats" style={{marginTop: 30}}>
                                    <div className="hero-stat">
                                        <div className="hero-stat-value" style={{fontSize: '2rem'}}>{stats.total}+</div>
                                        <div className="hero-stat-label">진행중인 경매</div>
                                    </div>
                                    <div className="hero-stat">
                                        <div className="hero-stat-value" style={{fontSize: '2rem'}}>{stats.bids}+</div>
                                        <div className="hero-stat-label">총 입찰 수</div>
                                    </div>
                                    <div className="hero-stat">
                                        <div className="hero-stat-value" style={{fontSize: '2rem'}}>24/7</div>
                                        <div className="hero-stat-label">실시간 운영</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        {loading ? (
                            <div className="loading">
                                <div className="spinner"></div>
                            </div>
                        ) : (
                            <>
                                {/* 인기 경매 */}
                                <div className="section-title" style={{marginTop: 20}}>
                                    <i className="fas fa-fire" style={{color: '#ef4444'}}></i>
                                    <span>인기 경매</span>
                                    <span style={{
                                        marginLeft: 10,
                                        background: '#ef4444',
                                        color: 'white',
                                        padding: '4px 12px',
                                        borderRadius: 4,
                                        fontSize: '0.8rem'
                                    }}>HOT</span>
                                </div>
                                <div className="auction-grid">
                                    {(popularAuctions.length > 0 ? popularAuctions : auctions.slice(0, 4)).map(auction => (
                                        <AuctionCard
                                            key={auction.id}
                                            auction={auction}
                                            onClick={() => handleAuctionClick(auction)}
                                            badge="hot"
                                            favoriteIds={favoriteIds}
                                        />
                                    ))}
                                </div>

                                {/* 마감 임박 */}
                                <div className="section-title">
                                    <i className="fas fa-clock" style={{color: '#f59e0b'}}></i>
                                    <span>마감 임박</span>
                                    <span style={{
                                        marginLeft: 10,
                                        background: '#f59e0b',
                                        color: 'white',
                                        padding: '4px 12px',
                                        borderRadius: 4,
                                        fontSize: '0.8rem'
                                    }}>ENDING SOON</span>
                                </div>
                                <div className="auction-grid">
                                    {(endingSoonAuctions.length > 0 ? endingSoonAuctions : auctions.slice(0, 4)).map(auction => (
                                        <AuctionCard
                                            key={auction.id}
                                            auction={auction}
                                            onClick={() => handleAuctionClick(auction)}
                                            badge="ending"
                                            favoriteIds={favoriteIds}
                                        />
                                    ))}
                                </div>
                            </>
                        )}
                    </main>

                    {/* 오른쪽 사이드바 - 현황 */}
                    <aside className="status-sidebar">
                        <div className="sidebar-card">
                            <div className="sidebar-card-header">
                                <i className="fas fa-chart-bar"></i>
                                내 활동 현황
                            </div>
                            <div className="sidebar-card-content">
                                <div className="status-item">
                                    <div className="status-icon buy">
                                        <i className="fas fa-shopping-bag"></i>
                                    </div>
                                    <div className="status-info">
                                        <div className="status-label">구매 완료</div>
                                        <div className="status-value">{userStats.purchases}건</div>
                                    </div>
                                    <span className="status-change up">+1</span>
                                </div>
                                <div className="status-item">
                                    <div className="status-icon sell">
                                        <i className="fas fa-store"></i>
                                    </div>
                                    <div className="status-info">
                                        <div className="status-label">판매 완료</div>
                                        <div className="status-value">{userStats.sales}건</div>
                                    </div>
                                </div>
                                <div className="status-item">
                                    <div className="status-icon bid">
                                        <i className="fas fa-gavel"></i>
                                    </div>
                                    <div className="status-info">
                                        <div className="status-label">입찰 중</div>
                                        <div className="status-value">{userStats.bids}건</div>
                                    </div>
                                    <span className="status-change up">+2</span>
                                </div>
                                <div className="status-item">
                                    <div className="status-icon favorite">
                                        <i className="fas fa-heart"></i>
                                    </div>
                                    <div className="status-info">
                                        <div className="status-label">찜 목록</div>
                                        <div className="status-value">{userStats.favorites}개</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div className="sidebar-card">
                            <div className="sidebar-card-header">
                                <i className="fas fa-clock"></i>
                                실시간 활동
                            </div>
                            <div className="sidebar-card-content" style={{padding: '8px 16px'}}>
                                <div className="activity-list">
                                    {recentActivities.map(activity => (
                                        <div key={activity.id} className="activity-item">
                                            <div className="activity-avatar">
                                                {activity.user.charAt(0)}
                                            </div>
                                            <div className="activity-content">
                                                <div className="activity-text">
                                                    <strong>{activity.user}</strong>님이
                                                    {activity.action === '입찰' && ` ${activity.item}에 ${activity.price.toLocaleString()}원 입찰`}
                                                    {activity.action === '낙찰' && ` ${activity.item} 낙찰`}
                                                    {activity.action === '등록' && ` ${activity.item} 등록`}
                                                </div>
                                                <div className="activity-time">{activity.time}</div>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </div>

                        <div className="sidebar-card">
                            <div className="sidebar-card-header">
                                <i className="fas fa-trophy"></i>
                                인기 카테고리
                            </div>
                            <div className="sidebar-card-content">
                                <div style={{display: 'flex', flexDirection: 'column', gap: 8}}>
                                    <div style={{display: 'flex', alignItems: 'center', justifyContent: 'space-between', padding: '8px 0'}}>
                                        <span style={{display: 'flex', alignItems: 'center', gap: 8}}>
                                            <i className="fas fa-laptop" style={{color: '#3b82f6'}}></i> 전자기기
                                        </span>
                                        <span style={{fontSize: '0.85rem', color: '#6b7280'}}>42%</span>
                                    </div>
                                    <div style={{height: 6, background: '#e5e7eb', borderRadius: 3}}>
                                        <div style={{height: '100%', width: '42%', background: '#3b82f6', borderRadius: 3}}></div>
                                    </div>
                                    <div style={{display: 'flex', alignItems: 'center', justifyContent: 'space-between', padding: '8px 0', marginTop: 8}}>
                                        <span style={{display: 'flex', alignItems: 'center', gap: 8}}>
                                            <i className="fas fa-gamepad" style={{color: '#8b5cf6'}}></i> 게임
                                        </span>
                                        <span style={{fontSize: '0.85rem', color: '#6b7280'}}>28%</span>
                                    </div>
                                    <div style={{height: 6, background: '#e5e7eb', borderRadius: 3}}>
                                        <div style={{height: '100%', width: '28%', background: '#8b5cf6', borderRadius: 3}}></div>
                                    </div>
                                    <div style={{display: 'flex', alignItems: 'center', justifyContent: 'space-between', padding: '8px 0', marginTop: 8}}>
                                        <span style={{display: 'flex', alignItems: 'center', gap: 8}}>
                                            <i className="fas fa-blender" style={{color: '#f59e0b'}}></i> 가전
                                        </span>
                                        <span style={{fontSize: '0.85rem', color: '#6b7280'}}>18%</span>
                                    </div>
                                    <div style={{height: 6, background: '#e5e7eb', borderRadius: 3}}>
                                        <div style={{height: '100%', width: '18%', background: '#f59e0b', borderRadius: 3}}></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </aside>
                </div>
            );
        }

        // 경매 카드 컴포넌트
        function AuctionCard({ auction, onClick, badge, favoriteIds = [] }) {
            const { user, token } = useContext(AuthContext);
            const [timeLeft, setTimeLeft] = useState('');
            const [isFavorite, setIsFavorite] = useState(favoriteIds.includes(auction.id));

            // favoriteIds prop이 변경되면 상태 업데이트
            useEffect(() => {
                setIsFavorite(favoriteIds.includes(auction.id));
            }, [favoriteIds, auction.id]);

            const handleFavoriteClick = async (e) => {
                e.stopPropagation();
                if (!user || !token) {
                    alert('로그인이 필요합니다');
                    return;
                }
                try {
                    if (!isFavorite) {
                        const res = await fetch(`${API_BASE}/auctions/favorite`, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                                'Authorization': `Bearer ${token}`
                            },
                            body: JSON.stringify({ auction_id: auction.id })
                        });
                        if (res.ok) {
                            setIsFavorite(true);
                        }
                    } else {
                        const res = await fetch(`${API_BASE}/auctions/favorite/${auction.id}`, {
                            method: 'DELETE',
                            headers: { 'Authorization': `Bearer ${token}` }
                        });
                        if (res.ok) {
                            setIsFavorite(false);
                        }
                    }
                } catch (err) {
                    console.error('찜 처리 실패:', err);
                }
            };

            useEffect(() => {
                const updateTime = () => {
                    const seconds = auction.remaining_seconds || 3600;
                    const hours = Math.floor(seconds / 3600);
                    const mins = Math.floor((seconds % 3600) / 60);
                    const secs = seconds % 60;

                    if (hours > 0) {
                        setTimeLeft(`${hours}시간 ${mins}분`);
                    } else if (mins > 0) {
                        setTimeLeft(`${mins}분 ${secs}초`);
                    } else {
                        setTimeLeft(`${secs}초`);
                    }
                };
                updateTime();
                const interval = setInterval(updateTime, 1000);
                return () => clearInterval(interval);
            }, [auction.remaining_seconds]);

            const getCategoryIcon = (category) => {
                const icons = {
                    '전자기기': 'fa-laptop',
                    '게임': 'fa-gamepad',
                    '가전': 'fa-blender',
                    '스포츠': 'fa-futbol',
                    '도서': 'fa-book',
                    '패션': 'fa-tshirt'
                };
                return icons[category] || 'fa-box';
            };

            return (
                <div className="auction-card" onClick={onClick}>
                    <div className="auction-image" style={auction.image_url ? {background: '#f5f5f5'} : {}}>
                        {auction.image_url ? (
                            <img
                                src={auction.image_url}
                                alt={auction.title}
                                style={{
                                    width: '100%',
                                    height: '100%',
                                    objectFit: 'cover'
                                }}
                                onError={(e) => {
                                    e.target.style.display = 'none';
                                    e.target.nextSibling.style.display = 'block';
                                }}
                            />
                        ) : null}
                        <i className={`fas ${getCategoryIcon(auction.category)}`} style={auction.image_url ? {display: 'none', position: 'absolute', top: '50%', left: '50%', transform: 'translate(-50%, -50%)'} : {}}></i>
                        {badge === 'hot' && <span className="auction-badge badge-hot"><i className="fas fa-fire"></i> HOT</span>}
                        {badge === 'ending' && <span className="auction-badge badge-ending"><i className="fas fa-clock"></i> 마감임박</span>}
                        {badge === 'new' && <span className="auction-badge badge-new"><i className="fas fa-star"></i> NEW</span>}
                        <button
                            className={`favorite-btn ${isFavorite ? 'active' : ''}`}
                            onClick={handleFavoriteClick}
                        >
                            <i className={`${isFavorite ? 'fas' : 'far'} fa-heart`}></i>
                        </button>
                    </div>
                    <div className="auction-content">
                        <div className="auction-category">{auction.category || '기타'}</div>
                        <div className="auction-title">{auction.title}</div>
                        <div className="auction-info">
                            <div className="current-price">{(auction.current_price || 0).toLocaleString()}원</div>
                            <div className="bid-count"><i className="fas fa-gavel"></i> {auction.bid_count || 0}회</div>
                        </div>
                        <div className="time-left">
                            <i className="fas fa-clock"></i> {timeLeft} 남음
                        </div>
                        <div className="progress-bar">
                            <div className="progress-fill" style={{width: `${Math.min(100, (auction.bid_count || 0) * 5)}%`}}></div>
                        </div>
                    </div>
                </div>
            );
        }

        // 경매 목록 페이지
        function AuctionListPage({ setCurrentPage, setSelectedAuction, filterCategory = '전체', setFilterCategory, filterPrice = { min: '', max: '' }, setFilterPrice, globalSearchKeyword = '', setGlobalSearchKeyword }) {
            const [auctions, setAuctions] = useState([]);
            const [loading, setLoading] = useState(true);
            const [searchTerm, setSearchTerm] = useState(globalSearchKeyword);
            const [selectedCategory, setSelectedCategory] = useState(filterCategory);
            const [priceRange, setPriceRange] = useState(filterPrice);
            const [favoriteIds, setFavoriteIds] = useState([]);
            const categories = ['전체', '전자기기', '게임', '가전', '스포츠', '도서', '패션', '기타'];

            // 찜 목록 한 번만 로드
            useEffect(() => {
                loadFavoriteIds();
            }, []);

            const loadFavoriteIds = async () => {
                try {
                    const token = localStorage.getItem('token');
                    if (!token) return;
                    const res = await fetch(`${API_BASE}/auctions/favorite/my`, {
                        headers: { 'Authorization': `Bearer ${token}` }
                    });
                    if (res.ok) {
                        const data = await res.json();
                        setFavoriteIds((data.favorites || []).map(f => f.id));
                    }
                } catch (err) {
                    console.log('찜 목록 로드 실패');
                }
            };

            useEffect(() => {
                setSelectedCategory(filterCategory);
                setPriceRange(filterPrice);
            }, [filterCategory, filterPrice]);

            // globalSearchKeyword가 변경되면 검색 실행
            useEffect(() => {
                if (globalSearchKeyword) {
                    setSearchTerm(globalSearchKeyword);
                    handleSearchWithKeyword(globalSearchKeyword);
                    // 검색 후 globalSearchKeyword 초기화
                    if (setGlobalSearchKeyword) {
                        setGlobalSearchKeyword('');
                    }
                }
            }, [globalSearchKeyword]);

            useEffect(() => {
                loadAuctions();
            }, [selectedCategory, priceRange]);

            const loadAuctions = async () => {
                setLoading(true);
                try {
                    let url = `${API_BASE}/auctions?status=진행중`;
                    if (selectedCategory !== '전체') {
                        url += `&category=${encodeURIComponent(selectedCategory)}`;
                    }
                    if (priceRange.min) {
                        url += `&minPrice=${priceRange.min}`;
                    }
                    if (priceRange.max) {
                        url += `&maxPrice=${priceRange.max}`;
                    }
                    const res = await fetch(url);
                    const data = await res.json();
                    setAuctions(data.auctions || []);
                } catch (err) {
                    // 데모 데이터
                    const demoAuctions = [
                        { id: 1, title: 'iPhone 14 Pro 256GB', category: '전자기기', current_price: 850000, bid_count: 15, remaining_seconds: 3600, status: '진행중' },
                        { id: 2, title: '맥북 프로 M2 14인치', category: '전자기기', current_price: 1650000, bid_count: 23, remaining_seconds: 7200, status: '진행중' },
                        { id: 3, title: '에어팟 프로 2세대', category: '전자기기', current_price: 220000, bid_count: 8, remaining_seconds: 1800, status: '진행중' },
                        { id: 4, title: '닌텐도 스위치 OLED', category: '게임', current_price: 320000, bid_count: 12, remaining_seconds: 5400, status: '진행중' },
                        { id: 5, title: '플레이스테이션 5', category: '게임', current_price: 480000, bid_count: 19, remaining_seconds: 3000, status: '진행중' },
                        { id: 6, title: '다이슨 에어랩', category: '가전', current_price: 420000, bid_count: 7, remaining_seconds: 10800, status: '진행중' },
                        { id: 7, title: '삼성 갤럭시 워치 6', category: '전자기기', current_price: 200000, bid_count: 5, remaining_seconds: 8000, status: '진행중' },
                        { id: 8, title: '캠핑 텐트 4인용', category: '스포츠', current_price: 280000, bid_count: 3, remaining_seconds: 12000, status: '진행중' },
                    ];
                    let filteredAuctions = demoAuctions;
                    if (selectedCategory !== '전체') {
                        filteredAuctions = filteredAuctions.filter(a => a.category === selectedCategory);
                    }
                    if (priceRange.min) {
                        filteredAuctions = filteredAuctions.filter(a => a.current_price >= Number(priceRange.min));
                    }
                    if (priceRange.max) {
                        filteredAuctions = filteredAuctions.filter(a => a.current_price <= Number(priceRange.max));
                    }
                    setAuctions(filteredAuctions);
                }
                setLoading(false);
            };

            const handleSearch = async () => {
                if (!searchTerm.trim()) {
                    loadAuctions();
                    return;
                }
                handleSearchWithKeyword(searchTerm);
            };

            const handleSearchWithKeyword = async (keyword) => {
                if (!keyword.trim()) {
                    loadAuctions();
                    return;
                }
                setLoading(true);
                try {
                    const res = await fetch(`${API_BASE}/auctions/search?q=${encodeURIComponent(keyword)}`);
                    const data = await res.json();
                    setAuctions(data.auctions || []);
                } catch (err) {
                    console.error(err);
                }
                setLoading(false);
            };

            const handleAuctionClick = (auction) => {
                setSelectedAuction(auction);
                setCurrentPage('detail');
            };

            const filteredAuctions = auctions.filter(a =>
                a.title.toLowerCase().includes(searchTerm.toLowerCase())
            );

            return (
                <div className="main-container">
                    <div className="search-section">
                        <div className="search-bar">
                            <div className="search-input-wrapper">
                                <i className="fas fa-search"></i>
                                <input
                                    type="text"
                                    className="search-input"
                                    placeholder="상품명, 카테고리로 검색..."
                                    value={searchTerm}
                                    onChange={(e) => setSearchTerm(e.target.value)}
                                    onKeyPress={(e) => e.key === 'Enter' && handleSearch()}
                                />
                            </div>
                            <button className="btn btn-primary" onClick={handleSearch}>
                                <i className="fas fa-search"></i> 검색
                            </button>
                        </div>
                        <div className="filter-chips">
                            {categories.map(cat => (
                                <span
                                    key={cat}
                                    className={`filter-chip ${selectedCategory === cat ? 'active' : ''}`}
                                    onClick={() => setSelectedCategory(cat)}
                                >
                                    {cat}
                                </span>
                            ))}
                        </div>
                    </div>

                    <div className="section-title">
                        <i className="fas fa-gavel"></i>
                        {selectedCategory === '전체' ? '전체 경매' : `${selectedCategory} 경매`}
                        <span style={{fontWeight: 400, fontSize: '1rem', color: 'var(--gray)', marginLeft: 10}}>
                            ({filteredAuctions.length}개)
                        </span>
                    </div>

                    {loading ? (
                        <div className="loading">
                            <div className="spinner"></div>
                        </div>
                    ) : filteredAuctions.length > 0 ? (
                        <div className="auction-grid">
                            {filteredAuctions.map(auction => (
                                <AuctionCard
                                    key={auction.id}
                                    auction={auction}
                                    onClick={() => handleAuctionClick(auction)}
                                    favoriteIds={favoriteIds}
                                />
                            ))}
                        </div>
                    ) : (
                        <div className="empty-state">
                            <i className="fas fa-search"></i>
                            <h3>검색 결과가 없습니다</h3>
                            <p>다른 검색어나 카테고리를 선택해보세요</p>
                        </div>
                    )}
                </div>
            );
        }

        // 경매 상세 페이지
        function AuctionDetailPage({ auction, setCurrentPage }) {
            const { user, token, points, setPoints } = useContext(AuthContext);
            const { addToast } = useContext(ToastContext);
            const [currentPrice, setCurrentPrice] = useState(auction?.current_price || 0);
            const [bidHistory, setBidHistory] = useState([]);
            const [bidAmount, setBidAmount] = useState('');
            const [timeLeft, setTimeLeft] = useState({ hours: 0, mins: 0, secs: 0 });
            const [viewerCount, setViewerCount] = useState(1);
            const [showBidSuccess, setShowBidSuccess] = useState(false);
            const [showConfetti, setShowConfetti] = useState(false);
            const [showTutorial, setShowTutorial] = useState(false);
            const [aiStrategy, setAiStrategy] = useState(null);
            const [isConnected, setIsConnected] = useState(false);
            const [pointsChange, setPointsChange] = useState(null);
            const [bidInputShake, setBidInputShake] = useState(false);
            const [chatMessages, setChatMessages] = useState([]);
            const [chatInput, setChatInput] = useState('');
            const [typingUsers, setTypingUsers] = useState([]);
            const [floatingReactions, setFloatingReactions] = useState([]);
            const [isFavorite, setIsFavorite] = useState(false);
            const [showReportModal, setShowReportModal] = useState(false);
            const [showInquiryModal, setShowInquiryModal] = useState(false);
            const [showCreditModal, setShowCreditModal] = useState(false);
            const [inquiryMessage, setInquiryMessage] = useState('');
            const [reportReason, setReportReason] = useState('');
            const [activeTab, setActiveTab] = useState('상품정보');
            const socketRef = useRef(null);
            const chatMessagesRef = useRef(null);

            // 공유하기
            const handleShare = async () => {
                const url = window.location.href;
                const text = `[BID달인] ${auction.title} - 현재가 ${currentPrice.toLocaleString()}원`;

                if (navigator.share) {
                    try {
                        await navigator.share({ title: auction.title, text, url });
                        addToast('공유되었습니다!', 'success');
                    } catch (err) {
                        if (err.name !== 'AbortError') {
                            navigator.clipboard.writeText(`${text}\n${url}`);
                            addToast('링크가 복사되었습니다!', 'success');
                        }
                    }
                } else {
                    navigator.clipboard.writeText(`${text}\n${url}`);
                    addToast('링크가 복사되었습니다!', 'success');
                }
            };

            // 신고하기
            const handleReport = () => {
                if (!reportReason.trim()) {
                    addToast('신고 사유를 입력해주세요', 'error');
                    return;
                }
                addToast('신고가 접수되었습니다. 검토 후 조치하겠습니다.', 'success');
                setShowReportModal(false);
                setReportReason('');
            };

            // 즐겨찾기 토글 (API 연동)
            const handleFavorite = async () => {
                if (!user) {
                    addToast('로그인이 필요합니다', 'error');
                    return;
                }
                try {
                    if (isFavorite) {
                        // 찜 제거
                        await fetch(`${API_BASE}/auctions/favorite/${auction.id}`, {
                            method: 'DELETE',
                            headers: { 'Authorization': `Bearer ${token}` }
                        });
                        setIsFavorite(false);
                        addToast('관심물품에서 제거되었습니다', 'info');
                    } else {
                        // 찜 추가
                        await fetch(`${API_BASE}/auctions/favorite`, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                                'Authorization': `Bearer ${token}`
                            },
                            body: JSON.stringify({ auction_id: auction.id })
                        });
                        setIsFavorite(true);
                        addToast('관심물품에 추가되었습니다!', 'success');
                    }
                } catch (err) {
                    addToast('오류가 발생했습니다', 'error');
                }
            };

            // 문의하기
            const handleInquiry = () => {
                if (!inquiryMessage.trim()) {
                    addToast('문의 내용을 입력해주세요', 'error');
                    return;
                }
                addToast('판매자에게 문의가 전송되었습니다!', 'success');
                setShowInquiryModal(false);
                setInquiryMessage('');
            };

            useEffect(() => {
                if (!auction) return;

                // 튜토리얼 표시 여부 확인
                const tutorialCompleted = localStorage.getItem('auctionTutorialCompleted');
                if (!tutorialCompleted && user) {
                    setTimeout(() => setShowTutorial(true), 800);
                }

                // 초기 데이터 로드
                loadAuctionDetail();
                loadBidHistory();
                loadAIStrategy();

                // 찜 상태 확인
                const checkFavoriteStatus = async () => {
                    if (token && auction) {
                        try {
                            const res = await fetch(`${API_BASE}/auctions/favorite/check/${auction.id}`, {
                                headers: { 'Authorization': `Bearer ${token}` }
                            });
                            const data = await res.json();
                            setIsFavorite(data.isFavorited);
                        } catch (err) {
                            console.error('찜 상태 확인 실패:', err);
                        }
                    }
                };
                checkFavoriteStatus();

                // 기존 소켓 정리
                if (socketRef.current) {
                    socketRef.current.disconnect();
                    socketRef.current = null;
                    setIsConnected(false);
                }

                // Socket.io 연결 (데모 토큰도 허용)
                if (token) {
                    connectSocket();
                }

                // 타이머
                const timer = setInterval(() => {
                    updateTimer();
                }, 1000);

                return () => {
                    clearInterval(timer);
                    if (socketRef.current) {
                        socketRef.current.emit('leave_auction', auction.id);
                        socketRef.current.disconnect();
                    }
                };
            }, [auction, token]);

            const connectSocket = () => {
                console.log('Connecting socket with token:', token ? 'exists' : 'missing');

                const socket = io(API_BASE, {
                    auth: { token },
                    transports: ['polling']  // App Engine Standard는 WebSocket 미지원
                });

                socket.on('connect', () => {
                    console.log('Socket connected, id:', socket.id);
                    setIsConnected(true);
                    socket.emit('join_auction', auction.id);
                    console.log('Joined auction room:', auction.id);
                });

                socket.on('connect_error', (error) => {
                    console.error('Socket connection error:', error.message);
                    setIsConnected(false);
                });

                socket.on('auction_info', (data) => {
                    setCurrentPrice(data.currentPrice);
                });

                socket.on('new_bid', (data) => {
                    setBidHistory(prev => [{
                        nickname: data.nickname,
                        bid_price: data.bidPrice,
                        bid_time: data.bidTime
                    }, ...prev].slice(0, 20));
                    setCurrentPrice(data.bidPrice);
                    addToast(`${data.nickname}님이 ${data.bidPrice.toLocaleString()}원에 입찰했습니다!`, 'info');
                });

                socket.on('price_update', (data) => {
                    setCurrentPrice(data.currentPrice);
                });

                socket.on('viewer_count', (data) => {
                    setViewerCount(data.count);
                });

                socket.on('bid_success', (data) => {
                    setShowBidSuccess(true);
                    setShowConfetti(true);
                    addToast('입찰 성공!', 'success');
                    setTimeout(() => {
                        setShowBidSuccess(false);
                        setShowConfetti(false);
                    }, 3000);
                });

                socket.on('bid_error', (data) => {
                    addToast(data.message, 'error');
                });

                socket.on('auction_ended', (data) => {
                    addToast('경매가 종료되었습니다!', 'info');
                });

                // 실시간 알림 리스너
                socket.on('notification', (data) => {
                    addToast(data.message || '새로운 알림이 있습니다!', data.type || 'info');
                });

                socket.on('outbid', (data) => {
                    addToast(`다른 사용자가 ${data.newPrice?.toLocaleString() || '더 높은 금액'}원에 입찰했습니다! 재입찰하세요.`, 'warning');
                });

                // 채팅 이벤트
                socket.on('new_chat', (data) => {
                    console.log('Received chat message:', data);
                    setChatMessages(prev => {
                        // 중복 메시지 필터링 (같은 id면 무시)
                        if (prev.some(m => m.id === data.id)) {
                            console.log('중복 메시지 무시:', data.id);
                            return prev;
                        }
                        return [...prev, data].slice(-100);
                    });
                    // 자동 스크롤
                    setTimeout(() => {
                        if (chatMessagesRef.current) {
                            chatMessagesRef.current.scrollTop = chatMessagesRef.current.scrollHeight;
                        }
                    }, 100);
                });

                socket.on('new_reaction', (data) => {
                    // 플로팅 이모지 추가
                    const reactionId = Date.now();
                    setFloatingReactions(prev => [...prev, { ...data, id: reactionId }]);
                    setTimeout(() => {
                        setFloatingReactions(prev => prev.filter(r => r.id !== reactionId));
                    }, 2000);
                });

                socket.on('user_typing', (data) => {
                    if (data.isTyping) {
                        setTypingUsers(prev => {
                            if (!prev.includes(data.nickname)) {
                                return [...prev, data.nickname];
                            }
                            return prev;
                        });
                    } else {
                        setTypingUsers(prev => prev.filter(n => n !== data.nickname));
                    }
                });

                socket.on('user_bidding', (data) => {
                    addToast(`${data.nickname}님이 입찰 준비 중...`, 'info');
                });

                socketRef.current = socket;
            };

            // 채팅 메시지 전송
            const sendChatMessage = () => {
                console.log('sendChatMessage called, socketRef:', socketRef.current ? 'exists' : 'null');

                if (!chatInput.trim()) {
                    console.log('Empty chat input');
                    return;
                }
                if (!socketRef.current) {
                    console.log('Socket not connected');
                    addToast('채팅 연결 중입니다. 잠시 후 다시 시도해주세요.', 'warning');
                    return;
                }

                const messageData = {
                    auctionId: auction.id,
                    message: chatInput.trim()
                };
                console.log('Emitting send_chat:', messageData);

                socketRef.current.emit('send_chat', messageData);
                setChatInput('');
            };

            // 이모지 반응 전송
            const sendReaction = (emoji) => {
                if (!socketRef.current) return;

                socketRef.current.emit('send_reaction', {
                    auctionId: auction.id,
                    emoji
                });
            };

            // 타이핑 인디케이터
            const handleChatInputChange = (e) => {
                setChatInput(e.target.value);
                if (socketRef.current) {
                    socketRef.current.emit('typing_start', auction.id);
                    // 2초 후 타이핑 종료
                    setTimeout(() => {
                        if (socketRef.current) {
                            socketRef.current.emit('typing_stop', auction.id);
                        }
                    }, 2000);
                }
            };

            const loadAuctionDetail = async () => {
                try {
                    const res = await fetch(`${API_BASE}/auctions/${auction.id}`);
                    const data = await res.json();
                    if (data.current_price) {
                        setCurrentPrice(data.current_price);
                    }
                } catch (err) {
                    console.error(err);
                }
            };

            const loadBidHistory = async () => {
                try {
                    const res = await fetch(`${API_BASE}/auctions/${auction.id}/bids`);
                    const data = await res.json();
                    setBidHistory(data.bids || []);
                } catch (err) {
                    // 데모 데이터
                    setBidHistory([
                        { nickname: '입찰마스터', bid_price: currentPrice, bid_time: new Date() },
                        { nickname: '경매왕', bid_price: currentPrice - 10000, bid_time: new Date(Date.now() - 60000) },
                        { nickname: '직거래러버', bid_price: currentPrice - 20000, bid_time: new Date(Date.now() - 120000) },
                    ]);
                }
            };

            const loadAIStrategy = async () => {
                try {
                    const res = await fetch(`${API_BASE}/auctions/${auction.id}/strategy`, {
                        headers: { Authorization: `Bearer ${token}` }
                    });
                    const data = await res.json();
                    setAiStrategy(data);
                } catch (err) {
                    // 데모 데이터
                    setAiStrategy({
                        strategy: '안정적',
                        recommended_price: currentPrice + 5000,
                        tip: '현재 경쟁이 치열하지 않습니다. 적정 금액으로 입찰하세요.'
                    });
                }
            };

            const updateTimer = () => {
                // end_time이 있으면 사용, 없으면 remaining_seconds 사용
                let remainingSeconds;
                if (auction?.end_time) {
                    const endTime = new Date(auction.end_time).getTime();
                    const now = Date.now();
                    remainingSeconds = Math.max(0, Math.floor((endTime - now) / 1000));
                } else {
                    remainingSeconds = auction?.remaining_seconds || 3600;
                }

                setTimeLeft({
                    hours: Math.floor(remainingSeconds / 3600),
                    mins: Math.floor((remainingSeconds % 3600) / 60),
                    secs: remainingSeconds % 60
                });
            };

            // 타이머 긴급도 클래스 반환
            const getTimerUrgency = () => {
                const totalSeconds = timeLeft.hours * 3600 + timeLeft.mins * 60 + timeLeft.secs;
                if (totalSeconds < 60) return 'urgent-danger';
                if (totalSeconds < 300) return 'urgent-warning';
                return '';
            };

            const handleBid = async () => {
                if (!user) {
                    addToast('로그인이 필요합니다', 'error');
                    return;
                }

                const amount = parseInt(bidAmount);
                if (!amount || amount <= currentPrice) {
                    addToast(`${currentPrice.toLocaleString()}원보다 높은 금액을 입력하세요`, 'error');
                    return;
                }

                if (amount > points) {
                    addToast('포인트가 부족합니다', 'error');
                    setBidInputShake(true);
                    setTimeout(() => setBidInputShake(false), 500);
                    return;
                }

                // Socket.io로 입찰
                if (socketRef.current && isConnected) {
                    socketRef.current.emit('place_bid', {
                        auctionId: auction.id,
                        bidPrice: amount
                    });
                } else {
                    // HTTP 폴백 (데모용)
                    setShowBidSuccess(true);
                    setShowConfetti(true);
                    const diff = amount - currentPrice;
                    setPointsChange(-diff);
                    setCurrentPrice(amount);
                    setPoints(prev => prev - diff);
                    setBidHistory(prev => [{
                        nickname: user.nickname || user.name,
                        bid_price: amount,
                        bid_time: new Date(),
                        isNew: true
                    }, ...prev]);
                    addToast('입찰 성공!', 'success');
                    setTimeout(() => {
                        setShowBidSuccess(false);
                        setShowConfetti(false);
                        setPointsChange(null);
                    }, 3000);
                }
                setBidAmount('');
            };

            const handleQuickBid = (increment) => {
                setBidAmount((currentPrice + increment).toString());
            };

            if (!auction) {
                return (
                    <div className="main-container">
                        <div className="empty-state">
                            <i className="fas fa-exclamation-circle"></i>
                            <h3>경매를 찾을 수 없습니다</h3>
                            <button className="btn btn-primary" onClick={() => setCurrentPage('auctions')}>
                                목록으로 돌아가기
                            </button>
                        </div>
                    </div>
                );
            }

            return (
                <div className="main-container">
                    <button className="btn btn-outline" onClick={() => setCurrentPage('auctions')} style={{marginBottom: 20}}>
                        <i className="fas fa-arrow-left"></i> 목록으로
                    </button>

                    <div className="auction-detail">
                        <div className="auction-main">
                            {/* 브레드크럼 */}
                            <div className="auction-breadcrumb">
                                <a href="#" onClick={(e) => {e.preventDefault(); setCurrentView('home')}}>홈</a>
                                <span>›</span>
                                <a href="#" onClick={(e) => e.preventDefault()}>{auction.category || '전체'}</a>
                                <span>›</span>
                                <span style={{color: '#1f2937'}}>{auction.title?.slice(0, 20)}...</span>
                            </div>

                            {/* 이미지 갤러리 */}
                            <div className="auction-gallery-container">
                                <div className="auction-thumbnails">
                                    <div className="auction-thumbnail active">
                                        {auction.image_url ? (
                                            <img src={auction.image_url} alt="썸네일 1" />
                                        ) : (
                                            <i className={`fas ${auction.category === '전자기기' ? 'fa-laptop' : auction.category === '게임' ? 'fa-gamepad' : 'fa-box'}`}></i>
                                        )}
                                    </div>
                                    <div className="auction-thumbnail">
                                        <i className="fas fa-image"></i>
                                    </div>
                                    <div className="auction-thumbnail">
                                        <i className="fas fa-image"></i>
                                    </div>
                                    <div className="auction-thumbnail">
                                        <i className="fas fa-image"></i>
                                    </div>
                                </div>
                                <div className="auction-main-image">
                                    {auction.image_url ? (
                                        <img src={auction.image_url} alt={auction.title} />
                                    ) : (
                                        <i className={`fas ${auction.category === '전자기기' ? 'fa-laptop' : auction.category === '게임' ? 'fa-gamepad' : 'fa-box'}`}></i>
                                    )}
                                    <button className="image-zoom-btn">
                                        <i className="fas fa-search-plus"></i>
                                    </button>
                                </div>
                            </div>

                            {/* 상품 정보 헤더 */}
                            <div className="auction-info-header">
                                <h1 className="auction-detail-title">{auction.title}</h1>
                                <div className="auction-meta">
                                    <div className="auction-meta-item">
                                        <i className="fas fa-tag"></i> {auction.category || '기타'}
                                    </div>
                                    <div className="auction-meta-item">
                                        <i className="fas fa-eye"></i> 조회 {auction.view_count || 0}
                                    </div>
                                    <div className="auction-meta-item">
                                        <i className="fas fa-heart"></i> 찜 {Math.floor(Math.random() * 50)}
                                    </div>
                                </div>
                            </div>

                            {/* 탭 네비게이션 */}
                            <div className="auction-tabs">
                                <button className={`auction-tab ${activeTab === '상품정보' ? 'active' : ''}`} onClick={() => setActiveTab('상품정보')}>상품정보</button>
                                <button className={`auction-tab ${activeTab === '입찰현황' ? 'active' : ''}`} onClick={() => setActiveTab('입찰현황')}>입찰현황 ({bidHistory.length})</button>
                                <button className={`auction-tab ${activeTab === '판매자정보' ? 'active' : ''}`} onClick={() => setActiveTab('판매자정보')}>판매자정보</button>
                                <button className={`auction-tab ${activeTab === '배송/교환/반품' ? 'active' : ''}`} onClick={() => setActiveTab('배송/교환/반품')}>배송/교환/반품</button>
                            </div>

                            {/* 상품 설명 탭 */}
                            {activeTab === '상품정보' && (
                                <div className="auction-description-section">
                                    <div className="auction-description">
                                        {auction.description || '상품 설명이 없습니다. 판매자에게 문의해주세요.'}
                                    </div>

                                    {/* AI 추천 */}
                                    {aiStrategy && (
                                        <div className="ai-recommendation" style={{marginTop: 20}}>
                                            <div className="ai-recommendation-header">
                                                <i className="fas fa-robot"></i> AI 입찰 전략 추천
                                            </div>
                                            <div className="ai-recommendation-content">
                                                <div className="ai-strategy">
                                                    <i className="fas fa-chess"></i> 전략: {aiStrategy.strategy}
                                                </div>
                                                <div className="ai-price">
                                                    추천 입찰가: {(aiStrategy.recommended_price || currentPrice + 5000).toLocaleString()}원
                                                </div>
                                                <div className="ai-tip">
                                                    <i className="fas fa-lightbulb"></i> {aiStrategy.tip}
                                                </div>
                                            </div>
                                        </div>
                                    )}
                                </div>
                            )}

                            {/* 입찰현황 탭 */}
                            {activeTab === '입찰현황' && (
                                <div className="auction-description-section" style={{padding: '20px'}}>
                                    <h3 style={{marginBottom: '16px', fontSize: '1.1rem', fontWeight: '600'}}>
                                        <i className="fas fa-gavel" style={{marginRight: '8px', color: 'var(--primary)'}}></i>
                                        입찰 내역 ({bidHistory.length}건)
                                    </h3>
                                    {bidHistory.length > 0 ? (
                                        <table style={{width: '100%', borderCollapse: 'collapse'}}>
                                            <thead>
                                                <tr style={{background: '#f5f5f5', borderBottom: '2px solid #e5e5e5'}}>
                                                    <th style={{padding: '12px', textAlign: 'left'}}>입찰자</th>
                                                    <th style={{padding: '12px', textAlign: 'right'}}>입찰가</th>
                                                    <th style={{padding: '12px', textAlign: 'center'}}>입찰시간</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {bidHistory.map((bid, idx) => (
                                                    <tr key={idx} style={{borderBottom: '1px solid #e5e5e5', background: idx === 0 ? '#fffbeb' : 'white'}}>
                                                        <td style={{padding: '12px'}}>
                                                            {idx === 0 && <i className="fas fa-crown" style={{color: '#f59e0b', marginRight: '8px'}}></i>}
                                                            {bid.nickname || bid.user_nickname || '입찰자'}
                                                        </td>
                                                        <td style={{padding: '12px', textAlign: 'right', fontWeight: idx === 0 ? '600' : '400', color: idx === 0 ? 'var(--primary)' : 'inherit'}}>
                                                            {(bid.bid_price || bid.amount).toLocaleString()}원
                                                        </td>
                                                        <td style={{padding: '12px', textAlign: 'center', color: '#666', fontSize: '0.9rem'}}>
                                                            {new Date(bid.bid_time || bid.created_at).toLocaleString('ko-KR')}
                                                        </td>
                                                    </tr>
                                                ))}
                                            </tbody>
                                        </table>
                                    ) : (
                                        <div style={{textAlign: 'center', padding: '40px', color: '#999'}}>
                                            <i className="fas fa-inbox" style={{fontSize: '2rem', marginBottom: '10px', display: 'block'}}></i>
                                            아직 입찰 내역이 없습니다
                                        </div>
                                    )}
                                </div>
                            )}

                            {/* 판매자정보 탭 */}
                            {activeTab === '판매자정보' && (
                                <div className="seller-info-section">
                                    <div className="seller-info">
                                        <div className="seller-avatar">
                                            {(auction.seller_nickname || '판매자')[0]}
                                        </div>
                                        <div className="seller-details">
                                            <div className="seller-name">{auction.seller_nickname || '판매자'}</div>
                                            <div className="seller-rating">
                                                <span><i className="fas fa-star"></i> 4.8</span>
                                                <span>|</span>
                                                <span>거래 23회</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div className="seller-stats">
                                        <div className="seller-stat">
                                            <div className="seller-stat-value">98%</div>
                                            <div className="seller-stat-label">만족도</div>
                                        </div>
                                        <div className="seller-stat">
                                            <div className="seller-stat-value">23건</div>
                                            <div className="seller-stat-label">판매완료</div>
                                        </div>
                                        <div className="seller-stat">
                                            <div className="seller-stat-value">빠름</div>
                                            <div className="seller-stat-label">응답속도</div>
                                        </div>
                                    </div>
                                    <div style={{marginTop: '20px', padding: '16px', background: '#f9f9f9', borderRadius: '8px'}}>
                                        <h4 style={{marginBottom: '12px', fontSize: '1rem'}}><i className="fas fa-info-circle" style={{marginRight: '8px'}}></i>판매자 소개</h4>
                                        <p style={{color: '#666', lineHeight: '1.6'}}>
                                            안녕하세요! 믿을 수 있는 거래를 약속드립니다.
                                            문의사항이 있으시면 언제든지 연락주세요.
                                        </p>
                                    </div>
                                    <button className="btn btn-outline" onClick={() => setShowInquiryModal(true)} style={{marginTop: '16px', width: '100%'}}>
                                        <i className="fas fa-envelope"></i> 판매자에게 문의하기
                                    </button>
                                </div>
                            )}

                            {/* 배송/교환/반품 탭 */}
                            {activeTab === '배송/교환/반품' && (
                                <div className="auction-description-section" style={{padding: '20px'}}>
                                    <div style={{marginBottom: '24px'}}>
                                        <h4 style={{marginBottom: '12px', color: 'var(--primary)'}}><i className="fas fa-truck" style={{marginRight: '8px'}}></i>배송 안내</h4>
                                        <ul style={{color: '#666', lineHeight: '1.8', paddingLeft: '20px'}}>
                                            <li>결제 완료 후 2~3일 이내 발송됩니다.</li>
                                            <li>배송비는 착불/선불 협의 가능합니다.</li>
                                            <li>직거래는 판매자와 별도 협의해주세요.</li>
                                        </ul>
                                    </div>
                                    <div style={{marginBottom: '24px'}}>
                                        <h4 style={{marginBottom: '12px', color: 'var(--primary)'}}><i className="fas fa-exchange-alt" style={{marginRight: '8px'}}></i>교환 안내</h4>
                                        <ul style={{color: '#666', lineHeight: '1.8', paddingLeft: '20px'}}>
                                            <li>경매 특성상 교환은 불가합니다.</li>
                                            <li>상품 설명과 현저히 다른 경우 판매자와 협의해주세요.</li>
                                        </ul>
                                    </div>
                                    <div>
                                        <h4 style={{marginBottom: '12px', color: 'var(--primary)'}}><i className="fas fa-undo" style={{marginRight: '8px'}}></i>반품 안내</h4>
                                        <ul style={{color: '#666', lineHeight: '1.8', paddingLeft: '20px'}}>
                                            <li>경매 특성상 단순 변심에 의한 반품은 불가합니다.</li>
                                            <li>상품 하자 시 수령 후 3일 이내 판매자에게 연락해주세요.</li>
                                            <li>반품 배송비는 귀책사유에 따라 결정됩니다.</li>
                                        </ul>
                                    </div>
                                </div>
                            )}
                        </div>

                        <div className="bid-panel">
                            {/* 상단 버튼 */}
                            <div className="bid-panel-header">
                                <button className="bid-panel-header-btn primary">연장경매 대상</button>
                                <button className="bid-panel-header-btn" onClick={handleShare}>
                                    <i className="fas fa-share-alt"></i> 공유
                                </button>
                                <button className="bid-panel-header-btn" onClick={() => setShowReportModal(true)}>
                                    <i className="fas fa-flag"></i> 신고
                                </button>
                            </div>

                            {/* 현재가 및 정보 */}
                            <div className="bid-status">
                                <div className="bid-status-row">
                                    <div className="bid-status-label">현재가</div>
                                    <div className="bid-current-price">{currentPrice.toLocaleString()}원</div>
                                </div>
                                <div className="bid-info-grid">
                                    <div className="bid-info-label">남은시간</div>
                                    <div className="bid-info-value time">
                                        {timeLeft.hours > 24 ? `${Math.floor(timeLeft.hours / 24)}일 ` : ''}
                                        {timeLeft.hours % 24}시간 {timeLeft.mins}분 {timeLeft.secs}초
                                        <span className="date">
                                            ({auction.end_time ? new Date(auction.end_time).toLocaleString('ko-KR') : '마감시간 없음'})
                                        </span>
                                    </div>
                                    <div className="bid-info-label">입찰기록</div>
                                    <div className="bid-info-value">
                                        {bidHistory.length}회
                                        <span style={{color: '#3b82f6', cursor: 'pointer', marginLeft: 8}}>[기록보기]</span>
                                    </div>
                                    <div className="bid-info-label">입찰단위</div>
                                    <div className="bid-info-value">1,000원</div>
                                </div>
                            </div>

                            {/* 입찰 섹션 */}
                            <div className="bid-input-section">
                                <div className="bid-input-row">
                                    <div className="bid-info-label">희망 입찰가</div>
                                    <div className="bid-input-wrapper">
                                        <button className="bid-adjust-btn" onClick={() => setBidAmount(String(Math.max(currentPrice + 1000, (parseInt(bidAmount) || currentPrice + 1000) - 1000)))}>−</button>
                                        <input
                                            type="number"
                                            className={`bid-input ${bidInputShake ? 'shake-animation' : ''}`}
                                            value={bidAmount || (currentPrice + 1000)}
                                            onChange={(e) => setBidAmount(e.target.value)}
                                        />
                                        <span className="bid-input-unit">원</span>
                                        <button className="bid-adjust-btn" onClick={() => setBidAmount(String((parseInt(bidAmount) || currentPrice) + 1000))}>+</button>
                                    </div>
                                </div>
                                <div className="bid-expected">
                                    <div className="bid-info-label">예상 구매가</div>
                                    <div className="bid-expected-value">
                                        {Math.floor((parseInt(bidAmount) || currentPrice + 1000) * 1.1).toLocaleString()}원
                                    </div>
                                    <span className="bid-expected-detail">
                                        ({(parseInt(bidAmount) || currentPrice + 1000).toLocaleString()}원 + 구매수수료 {Math.floor((parseInt(bidAmount) || currentPrice + 1000) * 0.1).toLocaleString()}원)
                                    </span>
                                </div>

                                {parseInt(bidAmount) > points && (
                                    <div style={{color: '#ef4444', fontSize: '0.85rem', marginBottom: 12, display: 'flex', alignItems: 'center', gap: 6}}>
                                        <i className="fas fa-exclamation-triangle"></i>
                                        포인트가 부족합니다 (보유: {points.toLocaleString()}P)
                                    </div>
                                )}

                                <div className="bid-buttons">
                                    <button className="bid-btn bid-btn-primary" onClick={handleBid}>
                                        입찰하기
                                    </button>
                                    <button className="bid-btn bid-btn-secondary" disabled>
                                        즉시구매 불가
                                    </button>
                                </div>
                                <div className="bid-sub-buttons">
                                    <button className="bid-btn bid-btn-outline" onClick={() => setActiveTab('배송/교환/반품')}>배송정보</button>
                                    <button
                                        className={`bid-btn bid-btn-outline ${isFavorite ? 'favorite-active' : ''}`}
                                        onClick={handleFavorite}
                                    >
                                        <i className={`${isFavorite ? 'fas' : 'far'} fa-heart`} style={{color: isFavorite ? '#ef4444' : 'inherit'}}></i> {isFavorite ? '관심물품 등록됨' : '관심물품'}
                                    </button>
                                </div>
                            </div>

                            {/* 판매자 정보 */}
                            <div className="seller-section">
                                <div className="seller-row">
                                    <div className="seller-info-box">
                                        <span className="bid-info-label">판매자</span>
                                        <span className="seller-name">{auction.seller_nickname || '판매자'}</span>
                                        <span className="seller-badge">
                                            <i className="fas fa-check-circle"></i> 인증
                                        </span>
                                    </div>
                                    <div className="seller-stats">
                                        <span>진행 중인 경매</span>
                                        <span style={{fontWeight: 600}}>{Math.floor(Math.random() * 10) + 1}건</span>
                                        <span style={{color: '#3b82f6', cursor: 'pointer'}}>[더보기]</span>
                                    </div>
                                </div>
                                <div className="seller-action-buttons">
                                    <button className="seller-action-btn" onClick={() => setShowCreditModal(true)}>
                                        <i className="fas fa-shield-alt"></i> 신용도 확인
                                    </button>
                                    <button className={`seller-action-btn ${isFavorite ? 'active' : ''}`} onClick={handleFavorite}>
                                        <i className={`${isFavorite ? 'fas' : 'far'} fa-star`}></i> {isFavorite ? '즐겨찾기됨' : '즐겨찾기'}
                                    </button>
                                    <button className="seller-action-btn" onClick={() => setShowInquiryModal(true)}>
                                        <i className="fas fa-comment-dots"></i> 문의하기
                                    </button>
                                </div>
                            </div>

                            {/* 포인트 표시 */}
                            <div className="bid-panel-points">
                                <div className="panel-points-label">보유 포인트</div>
                                <div className="panel-points-value">
                                    <i className="fas fa-coins"></i>
                                    {points.toLocaleString()}P
                                </div>
                            </div>

                            {/* 입찰 내역 */}
                            <div className="bid-history">
                                <div className="bid-history-title">
                                    <i className="fas fa-history"></i> 입찰 내역 ({bidHistory.length}회)
                                </div>
                                {bidHistory.length > 0 ? bidHistory.map((bid, idx) => (
                                    <div key={idx} className={`bid-item ${idx === 0 ? 'highlight' : ''}`}>
                                        <div className="bidder-info">
                                            <div className="bidder-avatar">{(bid.nickname || '익명')[0]}</div>
                                            <div>
                                                <div style={{fontWeight: 500, fontSize: '0.9rem'}}>{bid.nickname || '익명'}</div>
                                                <div className="bid-time">
                                                    {new Date(bid.bid_time).toLocaleString('ko-KR')}
                                                </div>
                                            </div>
                                        </div>
                                        <div className="bid-amount">{(bid.bid_price || 0).toLocaleString()}원</div>
                                    </div>
                                )) : (
                                    <div style={{textAlign: 'center', color: '#9ca3af', padding: 30}}>
                                        아직 입찰 내역이 없습니다
                                    </div>
                                )}
                            </div>
                        </div>
                    </div>

                    {/* 실시간 채팅 */}
                    <div className="chat-container">
                        <div className="chat-header">
                            <h3>
                                <i className="fas fa-comments"></i> 실시간 채팅
                            </h3>
                            <div className="chat-online-count">
                                <i className="fas fa-users"></i> {viewerCount}명 참여중
                            </div>
                        </div>

                        <div className="chat-reactions">
                            <button className="reaction-btn" onClick={() => sendReaction('👍')}>👍</button>
                            <button className="reaction-btn" onClick={() => sendReaction('🔥')}>🔥</button>
                            <button className="reaction-btn" onClick={() => sendReaction('😮')}>😮</button>
                            <button className="reaction-btn" onClick={() => sendReaction('💰')}>💰</button>
                            <button className="reaction-btn" onClick={() => sendReaction('🎉')}>🎉</button>
                        </div>

                        <div className="chat-messages" ref={chatMessagesRef}>
                            <div className="chat-system-message">
                                <i className="fas fa-info-circle"></i>
                                경매 채팅방에 오신 것을 환영합니다!
                            </div>
                            {chatMessages.map((msg, idx) => {
                                const isOwn = Number(msg.userId) === Number(user?.id);
                                return (
                                    <div key={msg.id || idx} className={`chat-message ${isOwn ? 'own' : ''}`}>
                                        <div className="chat-avatar">
                                            {(msg.nickname || '익명')[0]}
                                        </div>
                                        <div className="chat-bubble">
                                            <div className="chat-nickname">{msg.nickname}</div>
                                            <div className="chat-text">{msg.message}</div>
                                            <div className="chat-time">
                                                {new Date(msg.timestamp).toLocaleTimeString()}
                                            </div>
                                        </div>
                                    </div>
                                );
                            })}
                            {typingUsers.length > 0 && (
                                <div className="chat-typing">
                                    {typingUsers.join(', ')}님이 입력 중...
                                </div>
                            )}
                        </div>

                        {!isConnected && user && (
                            <div style={{padding: '8px 16px', background: '#fef3c7', color: '#92400e', fontSize: '0.8rem', textAlign: 'center'}}>
                                <i className="fas fa-spinner fa-spin"></i> 실시간 연결 중...
                            </div>
                        )}
                        <div className="chat-input-area">
                            <input
                                type="text"
                                className="chat-input"
                                placeholder={user ? (isConnected ? "메시지를 입력하세요..." : "연결 중...") : "채팅하려면 로그인하세요"}
                                value={chatInput}
                                onChange={handleChatInputChange}
                                onKeyPress={(e) => e.key === 'Enter' && sendChatMessage()}
                                disabled={!user || !isConnected}
                            />
                            <button
                                className="chat-send-btn"
                                onClick={sendChatMessage}
                                disabled={!user || !chatInput.trim() || !isConnected}
                            >
                                <i className="fas fa-paper-plane"></i>
                            </button>
                        </div>
                    </div>

                    {/* 플로팅 이모지 반응 */}
                    {floatingReactions.map(reaction => (
                        <div
                            key={reaction.id}
                            className="reaction-float"
                            style={{
                                left: `${Math.random() * 80 + 10}%`,
                                bottom: '20%'
                            }}
                        >
                            {reaction.emoji}
                        </div>
                    ))}

                    {/* 입찰 성공 애니메이션 */}
                    {showBidSuccess && (
                        <div className="bid-success-animation">
                            <div className="bid-success-icon">
                                <i className="fas fa-check-circle"></i>
                            </div>
                            <div className="bid-success-text">입찰 성공!</div>
                            {bidAmount && (
                                <div className="bid-success-amount">
                                    {parseInt(bidAmount).toLocaleString()}원
                                </div>
                            )}
                        </div>
                    )}

                    {/* Confetti 효과 */}
                    {showConfetti && <ConfettiEffect />}

                    {/* 튜토리얼 가이드 */}
                    {showTutorial && <AuctionTutorial onComplete={() => setShowTutorial(false)} />}

                    {/* 신고 모달 */}
                    {showReportModal && (
                        <div className="modal-overlay" onClick={() => setShowReportModal(false)}>
                            <div className="modal-content" onClick={(e) => e.stopPropagation()}>
                                <div className="modal-header">
                                    <h3><i className="fas fa-flag"></i> 상품 신고하기</h3>
                                    <button className="modal-close" onClick={() => setShowReportModal(false)}>
                                        <i className="fas fa-times"></i>
                                    </button>
                                </div>
                                <div className="modal-body">
                                    <div className="form-group">
                                        <label>신고 사유 선택</label>
                                        <select
                                            className="form-input"
                                            value={reportReason}
                                            onChange={(e) => setReportReason(e.target.value)}
                                        >
                                            <option value="">신고 사유를 선택하세요</option>
                                            <option value="fake">허위 상품 정보</option>
                                            <option value="fraud">사기 의심</option>
                                            <option value="illegal">불법 상품</option>
                                            <option value="price">가격 조작 의심</option>
                                            <option value="other">기타</option>
                                        </select>
                                    </div>
                                    <div className="form-group">
                                        <label>상세 내용</label>
                                        <textarea
                                            className="form-input"
                                            rows="4"
                                            placeholder="신고 사유를 상세히 작성해주세요..."
                                            value={reportReason === 'other' ? '' : undefined}
                                            onChange={(e) => setReportReason(e.target.value)}
                                        ></textarea>
                                    </div>
                                </div>
                                <div className="modal-footer">
                                    <button className="btn btn-outline" onClick={() => setShowReportModal(false)}>취소</button>
                                    <button className="btn btn-primary" onClick={handleReport}>신고하기</button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* 문의하기 모달 */}
                    {showInquiryModal && (
                        <div className="modal-overlay" onClick={() => setShowInquiryModal(false)}>
                            <div className="modal-content" onClick={(e) => e.stopPropagation()}>
                                <div className="modal-header">
                                    <h3><i className="fas fa-comment-dots"></i> 판매자에게 문의하기</h3>
                                    <button className="modal-close" onClick={() => setShowInquiryModal(false)}>
                                        <i className="fas fa-times"></i>
                                    </button>
                                </div>
                                <div className="modal-body">
                                    <div className="seller-inquiry-info">
                                        <div className="seller-avatar">{(auction.seller_nickname || '판매자')[0]}</div>
                                        <div>
                                            <div style={{fontWeight: 600}}>{auction.seller_nickname || '판매자'}</div>
                                            <div style={{color: '#6b7280', fontSize: '0.9rem'}}>보통 1시간 내 응답</div>
                                        </div>
                                    </div>
                                    <div className="inquiry-quick-btns">
                                        <button className="quick-btn" onClick={() => setInquiryMessage('상품 상태가 어떤가요?')}>상품 상태 문의</button>
                                        <button className="quick-btn" onClick={() => setInquiryMessage('직거래 가능한가요?')}>직거래 문의</button>
                                        <button className="quick-btn" onClick={() => setInquiryMessage('가격 네고 가능한가요?')}>가격 협상</button>
                                    </div>
                                    <div className="form-group">
                                        <label>문의 내용</label>
                                        <textarea
                                            className="form-input"
                                            rows="4"
                                            placeholder="판매자에게 궁금한 점을 문의해보세요..."
                                            value={inquiryMessage}
                                            onChange={(e) => setInquiryMessage(e.target.value)}
                                        ></textarea>
                                    </div>
                                </div>
                                <div className="modal-footer">
                                    <button className="btn btn-outline" onClick={() => setShowInquiryModal(false)}>취소</button>
                                    <button className="btn btn-primary" onClick={handleInquiry}>문의 보내기</button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* 신용도 확인 모달 */}
                    {showCreditModal && (
                        <div className="modal-overlay" onClick={() => setShowCreditModal(false)}>
                            <div className="modal-content" onClick={(e) => e.stopPropagation()}>
                                <div className="modal-header">
                                    <h3><i className="fas fa-shield-alt"></i> 판매자 신용도</h3>
                                    <button className="modal-close" onClick={() => setShowCreditModal(false)}>
                                        <i className="fas fa-times"></i>
                                    </button>
                                </div>
                                <div className="modal-body">
                                    <div className="credit-profile">
                                        <div className="credit-avatar">{(auction.seller_nickname || '판매자')[0]}</div>
                                        <div className="credit-name">{auction.seller_nickname || '판매자'}</div>
                                        <div className="credit-badge">
                                            <i className="fas fa-check-circle"></i> 인증된 판매자
                                        </div>
                                    </div>
                                    <div className="credit-score-section">
                                        <div className="credit-score-circle">
                                            <div className="credit-score-value">98</div>
                                            <div className="credit-score-label">점</div>
                                        </div>
                                        <div className="credit-grade">최우수 등급</div>
                                    </div>
                                    <div className="credit-stats-grid">
                                        <div className="credit-stat-item">
                                            <div className="credit-stat-value">156건</div>
                                            <div className="credit-stat-label">총 거래</div>
                                        </div>
                                        <div className="credit-stat-item">
                                            <div className="credit-stat-value">99.2%</div>
                                            <div className="credit-stat-label">거래 성공률</div>
                                        </div>
                                        <div className="credit-stat-item">
                                            <div className="credit-stat-value">4.9</div>
                                            <div className="credit-stat-label">평균 평점</div>
                                        </div>
                                        <div className="credit-stat-item">
                                            <div className="credit-stat-value">1시간</div>
                                            <div className="credit-stat-label">평균 응답</div>
                                        </div>
                                    </div>
                                    <div className="credit-reviews">
                                        <div className="credit-review-title">최근 후기</div>
                                        <div className="credit-review-item">
                                            <div className="review-stars">⭐⭐⭐⭐⭐</div>
                                            <div className="review-text">빠른 배송, 상품 상태 좋아요!</div>
                                            <div className="review-date">2026.02.05</div>
                                        </div>
                                        <div className="credit-review-item">
                                            <div className="review-stars">⭐⭐⭐⭐⭐</div>
                                            <div className="review-text">친절하고 믿을 수 있는 판매자입니다.</div>
                                            <div className="review-date">2026.02.03</div>
                                        </div>
                                    </div>
                                </div>
                                <div className="modal-footer">
                                    <button className="btn btn-primary" onClick={() => setShowCreditModal(false)}>확인</button>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        // 경매 등록 페이지
        function CreateAuctionPage({ setCurrentPage }) {
            const { user, token } = useContext(AuthContext);
            const { addToast } = useContext(ToastContext);
            const [formData, setFormData] = useState({
                title: '',
                description: '',
                category: '전자기기',
                start_price: '',
                buy_now_price: '',
                duration: 24
            });
            const [loading, setLoading] = useState(false);
            const [predictedPrice, setPredictedPrice] = useState(null);
            const [imageFile, setImageFile] = useState(null);
            const [imagePreview, setImagePreview] = useState(null);
            const [analyzing, setAnalyzing] = useState(false);
            const [analysisResult, setAnalysisResult] = useState(null);

            const categories = ['전자기기', '게임', '가전', '스포츠', '도서', '패션', '기타'];

            // 이미지 업로드 (AI 분석 없이)
            const handleImageUpload = (e) => {
                const file = e.target.files[0];
                if (!file) return;

                // 파일 크기 체크 (10MB)
                if (file.size > 10 * 1024 * 1024) {
                    addToast('파일 크기는 10MB 이하여야 합니다', 'error');
                    return;
                }

                // 파일 타입 체크
                if (!['image/jpeg', 'image/png', 'image/webp'].includes(file.type)) {
                    addToast('JPEG, PNG, WebP 이미지만 지원합니다', 'error');
                    return;
                }

                setImageFile(file);
                setImagePreview(URL.createObjectURL(file));
                setAnalysisResult(null);
                addToast('이미지가 추가되었습니다', 'success');
            };

            // AI 분석 버튼 클릭 시 실행
            const handleAIAnalysis = async () => {
                if (!imageFile) {
                    addToast('먼저 이미지를 업로드해주세요', 'error');
                    return;
                }

                setAnalyzing(true);
                setAnalysisResult(null);

                try {
                    const uploadFormData = new FormData();
                    uploadFormData.append('image', imageFile);

                    const res = await fetch(`${API_BASE}/auctions/analyze-image`, {
                        method: 'POST',
                        headers: {
                            'Authorization': `Bearer ${token}`
                        },
                        body: uploadFormData
                    });

                    const data = await res.json();
                    if (data.success && data.analysis) {
                        setAnalysisResult(data.analysis);

                        // 폼 자동 채우기
                        setFormData(prev => ({
                            ...prev,
                            title: data.analysis.title || prev.title,
                            category: data.analysis.category || prev.category,
                            description: data.analysis.description || prev.description,
                            start_price: data.analysis.price_min || prev.start_price
                        }));

                        addToast('AI가 상품을 분석했습니다!', 'success');
                    } else {
                        throw new Error('분석 실패');
                    }
                } catch (err) {
                    console.error('이미지 분석 실패:', err);
                    addToast('AI 분석에 실패했습니다. 잠시 후 다시 시도해주세요.', 'error');
                }
                setAnalyzing(false);
            };

            const removeImage = () => {
                setImageFile(null);
                setImagePreview(null);
                setAnalysisResult(null);
            };

            const handleSubmit = async (e) => {
                e.preventDefault();

                if (!user) {
                    addToast('로그인이 필요합니다', 'error');
                    return;
                }

                if (!formData.title || !formData.start_price) {
                    addToast('필수 항목을 입력해주세요', 'error');
                    return;
                }

                setLoading(true);
                try {
                    // FormData를 사용하여 이미지와 데이터 함께 전송
                    const submitData = new FormData();
                    submitData.append('title', formData.title);
                    submitData.append('description', formData.description);
                    submitData.append('category', formData.category);
                    submitData.append('start_price', formData.start_price);
                    if (formData.buy_now_price) {
                        submitData.append('buy_now_price', formData.buy_now_price);
                    }
                    submitData.append('duration', formData.duration);

                    // 이미지 파일이 있으면 추가
                    if (imageFile) {
                        submitData.append('image', imageFile);
                    }

                    const res = await fetch(`${API_BASE}/auctions`, {
                        method: 'POST',
                        headers: {
                            'Authorization': `Bearer ${token}`
                        },
                        body: submitData
                    });

                    const data = await res.json();
                    if (res.ok) {
                        addToast('경매가 등록되었습니다!', 'success');
                        setPredictedPrice(data.predictedPrice);
                        setCurrentPage('auctions');
                    } else {
                        addToast(data.message || '등록 실패', 'error');
                    }
                } catch (err) {
                    // 데모용 성공 처리
                    addToast('경매가 등록되었습니다! (데모)', 'success');
                    setPredictedPrice(Math.floor(parseInt(formData.start_price) * 1.3));
                    setTimeout(() => setCurrentPage('auctions'), 1500);
                }
                setLoading(false);
            };

            const handleChange = (e) => {
                setFormData({
                    ...formData,
                    [e.target.name]: e.target.value
                });
            };

            if (!user) {
                return (
                    <div className="main-container">
                        <div className="empty-state">
                            <i className="fas fa-lock"></i>
                            <h3>로그인이 필요합니다</h3>
                            <p>경매를 등록하려면 먼저 로그인해주세요</p>
                            <button className="btn btn-primary" onClick={() => setCurrentPage('login')}>
                                로그인하기
                            </button>
                        </div>
                    </div>
                );
            }

            return (
                <div className="main-container">
                    <div style={{maxWidth: 700, margin: '0 auto'}}>
                        <h1 style={{marginBottom: 30}}>
                            <i className="fas fa-plus-circle" style={{color: 'var(--primary)'}}></i> 새 경매 등록
                        </h1>

                        <form onSubmit={handleSubmit} style={{background: 'white', borderRadius: 4, padding: 40, boxShadow: '0 4px 20px rgba(0,0,0,0.08)'}}>
                            {/* 이미지 업로드 섹션 */}
                            <div className="form-group">
                                <label className="form-label">
                                    <i className="fas fa-camera"></i> 상품 이미지
                                </label>
                                <div className="image-upload-area">
                                    {imagePreview ? (
                                        <div className="image-preview-container">
                                            <img src={imagePreview} alt="상품 미리보기" />
                                            <button
                                                type="button"
                                                className="image-preview-remove"
                                                onClick={removeImage}
                                            >
                                                <i className="fas fa-times"></i>
                                            </button>
                                        </div>
                                    ) : (
                                        <label className="upload-placeholder">
                                            <input
                                                type="file"
                                                accept="image/jpeg,image/png,image/webp"
                                                onChange={handleImageUpload}
                                                hidden
                                            />
                                            <i className="fas fa-cloud-upload-alt"></i>
                                            <span>클릭하여 이미지를 업로드하세요</span>
                                            <span style={{fontSize: '0.85rem', color: 'var(--gray-light)'}}>
                                                JPEG, PNG, WebP / 최대 10MB
                                            </span>
                                        </label>
                                    )}
                                    {analyzing && (
                                        <div className="analyzing-overlay">
                                            <i className="fas fa-spinner fa-spin"></i>
                                            <span>AI가 상품을 분석하고 있습니다...</span>
                                        </div>
                                    )}
                                </div>

                                {/* AI 분석 버튼 */}
                                {imagePreview && !analyzing && (
                                    <button
                                        type="button"
                                        className="btn btn-ai-analyze"
                                        onClick={handleAIAnalysis}
                                    >
                                        <i className="fas fa-robot"></i> AI로 상품 분석하기
                                    </button>
                                )}

                                {/* AI 분석 결과 */}
                                {analysisResult && (
                                    <div className="ai-analysis-result">
                                        <h4>
                                            <i className="fas fa-robot"></i> AI 분석 결과
                                        </h4>
                                        <div className="ai-analysis-item">
                                            <span className="ai-analysis-label">추천 상품명</span>
                                            <span className="ai-analysis-value">{analysisResult.title}</span>
                                        </div>
                                        <div className="ai-analysis-item">
                                            <span className="ai-analysis-label">카테고리</span>
                                            <span className="ai-analysis-value">{analysisResult.category}</span>
                                        </div>
                                        <div className="ai-analysis-item">
                                            <span className="ai-analysis-label">상태</span>
                                            <span className="ai-analysis-value">{analysisResult.condition}</span>
                                        </div>
                                        <div className="ai-analysis-item">
                                            <span className="ai-analysis-label">예상 가격대</span>
                                            <span className="ai-analysis-value">
                                                {analysisResult.price_min?.toLocaleString()}원 ~ {analysisResult.price_max?.toLocaleString()}원
                                            </span>
                                        </div>
                                    </div>
                                )}
                            </div>

                            <div className="form-group">
                                <label className="form-label">상품명 *</label>
                                <input
                                    type="text"
                                    className="form-input"
                                    name="title"
                                    value={formData.title}
                                    onChange={handleChange}
                                    placeholder="상품명을 입력하세요"
                                    required
                                />
                            </div>

                            <div className="form-group">
                                <label className="form-label">카테고리</label>
                                <select
                                    className="form-select"
                                    name="category"
                                    value={formData.category}
                                    onChange={handleChange}
                                >
                                    {categories.map(cat => (
                                        <option key={cat} value={cat}>{cat}</option>
                                    ))}
                                </select>
                            </div>

                            <div className="form-group">
                                <label className="form-label">상품 설명</label>
                                <textarea
                                    className="form-input form-textarea"
                                    name="description"
                                    value={formData.description}
                                    onChange={handleChange}
                                    placeholder="상품의 상태, 특징 등을 자세히 설명해주세요"
                                />
                            </div>

                            <div style={{display: 'grid', gridTemplateColumns: '1fr 1fr', gap: 20}}>
                                <div className="form-group">
                                    <label className="form-label">시작가 *</label>
                                    <input
                                        type="number"
                                        className="form-input"
                                        name="start_price"
                                        value={formData.start_price}
                                        onChange={handleChange}
                                        placeholder="1000"
                                        min="1000"
                                        required
                                    />
                                </div>

                                <div className="form-group">
                                    <label className="form-label">즉시구매가 (선택)</label>
                                    <input
                                        type="number"
                                        className="form-input"
                                        name="buy_now_price"
                                        value={formData.buy_now_price}
                                        onChange={handleChange}
                                        placeholder="미설정"
                                        min="1000"
                                    />
                                </div>
                            </div>

                            <div className="form-group">
                                <label className="form-label">경매 기간</label>
                                <select
                                    className="form-select"
                                    name="duration"
                                    value={formData.duration}
                                    onChange={handleChange}
                                >
                                    <option value={6}>6시간</option>
                                    <option value={12}>12시간</option>
                                    <option value={24}>24시간 (1일)</option>
                                    <option value={48}>48시간 (2일)</option>
                                    <option value={72}>72시간 (3일)</option>
                                    <option value={168}>168시간 (7일)</option>
                                </select>
                            </div>

                            {predictedPrice && (
                                <div className="ai-recommendation" style={{marginBottom: 20}}>
                                    <div className="ai-recommendation-header">
                                        <i className="fas fa-robot"></i> AI 예측 낙찰가
                                    </div>
                                    <div className="ai-recommendation-content">
                                        <div className="ai-price">
                                            {predictedPrice.toLocaleString()}원
                                        </div>
                                        <div className="ai-tip">
                                            AI가 예측한 이 상품의 예상 낙찰가입니다.
                                        </div>
                                    </div>
                                </div>
                            )}

                            <button
                                type="submit"
                                className="btn btn-primary btn-lg"
                                style={{width: '100%'}}
                                disabled={loading}
                            >
                                {loading ? (
                                    <><i className="fas fa-spinner fa-spin"></i> 등록 중...</>
                                ) : (
                                    <><i className="fas fa-gavel"></i> 경매 등록하기</>
                                )}
                            </button>
                        </form>
                    </div>
                </div>
            );
        }

        // 마이페이지
        function MyPage({ setCurrentPage, setSelectedAuction }) {
            const { user, points, setPoints, token } = useContext(AuthContext);
            const { addToast } = useContext(ToastContext);
            const [activeTab, setActiveTab] = useState('bids');
            const [myBids, setMyBids] = useState([]);
            const [myAuctions, setMyAuctions] = useState([]);
            const [myFavorites, setMyFavorites] = useState([]);
            const [pointHistory, setPointHistory] = useState([]);
            const [showChargeModal, setShowChargeModal] = useState(false);
            const [chargeAmount, setChargeAmount] = useState(10000);
            const [loading, setLoading] = useState(false);
            // 경매 수정 모달 상태
            const [showEditModal, setShowEditModal] = useState(false);
            const [editingAuction, setEditingAuction] = useState(null);
            const [editForm, setEditForm] = useState({
                title: '',
                description: '',
                category: '',
                image_url: ''
            });
            const [editImageFile, setEditImageFile] = useState(null);
            const [editImagePreview, setEditImagePreview] = useState('');

            useEffect(() => {
                if (user) {
                    loadMyData();
                }
            }, [user, activeTab]);

            const loadMyData = async () => {
                try {
                    // 실제 API에서 내 입찰 내역 가져오기
                    const bidsRes = await fetch(`${API_BASE}/users/my-bids`, {
                        headers: { 'Authorization': `Bearer ${token}` }
                    });
                    if (bidsRes.ok) {
                        const bidsData = await bidsRes.json();
                        setMyBids(bidsData.bids || []);
                    }

                    // 내가 등록한 경매
                    const auctionsRes = await fetch(`${API_BASE}/users/my-auctions`, {
                        headers: { 'Authorization': `Bearer ${token}` }
                    });
                    if (auctionsRes.ok) {
                        const auctionsData = await auctionsRes.json();
                        setMyAuctions(auctionsData.auctions || []);
                    }

                    // 포인트 내역
                    const pointsRes = await fetch(`${API_BASE}/users/points-history`, {
                        headers: { 'Authorization': `Bearer ${token}` }
                    });
                    if (pointsRes.ok) {
                        const pointsData = await pointsRes.json();
                        setPointHistory(pointsData.history || []);
                    }

                    // 찜 목록 가져오기
                    const favoritesRes = await fetch(`${API_BASE}/auctions/favorite/my`, {
                        headers: { 'Authorization': `Bearer ${token}` }
                    });
                    if (favoritesRes.ok) {
                        const favoritesData = await favoritesRes.json();
                        setMyFavorites(favoritesData.favorites || []);
                    }
                } catch (error) {
                    console.log('데이터 로드 실패, 데모 데이터 사용');
                    // 폴백 데모 데이터
                    setMyBids([]);
                    setMyAuctions([]);
                    setMyFavorites([]);
                    setPointHistory([
                        { id: 1, amount: 100000, reason: '신규 가입 보너스', created_at: new Date().toISOString() }
                    ]);
                }
            };

            const handleChargePoints = async () => {
                setLoading(true);
                try {
                    const res = await fetch(`${API_BASE}/users/charge-points`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${token}`
                        },
                        body: JSON.stringify({ amount: Number(chargeAmount) })
                    });

                    if (res.ok) {
                        const data = await res.json();
                        setPoints(Number(data.newBalance));
                        addToast(`${Number(chargeAmount).toLocaleString()}P 충전 완료!`, 'success');
                        setShowChargeModal(false);
                        loadMyData();
                    } else {
                        // 데모 모드: 직접 포인트 추가
                        setPoints(prev => Number(prev) + Number(chargeAmount));
                        addToast(`${Number(chargeAmount).toLocaleString()}P 충전 완료! (데모)`, 'success');
                        setShowChargeModal(false);
                    }
                } catch (error) {
                    // 데모 모드
                    setPoints(prev => Number(prev) + Number(chargeAmount));
                    addToast(`${Number(chargeAmount).toLocaleString()}P 충전 완료! (데모)`, 'success');
                    setShowChargeModal(false);
                }
                setLoading(false);
            };

            // 경매 삭제 처리
            const handleDeleteAuction = async (auctionId) => {
                if (!window.confirm('정말 이 경매를 삭제하시겠습니까?')) {
                    return;
                }
                try {
                    const res = await fetch(`${API_BASE}/auctions/${auctionId}`, {
                        method: 'DELETE',
                        headers: { 'Authorization': `Bearer ${token}` }
                    });
                    if (res.ok) {
                        addToast('경매가 삭제되었습니다', 'success');
                        loadMyData();
                    } else {
                        const data = await res.json();
                        addToast(data.message || '삭제 실패', 'error');
                    }
                } catch (err) {
                    addToast('삭제 중 오류가 발생했습니다', 'error');
                }
            };

            // 경매 수정 모달 열기
            const openEditModal = (auction) => {
                setEditingAuction(auction);
                setEditForm({
                    title: auction.title,
                    description: auction.description || '',
                    category: auction.category || '기타',
                    image_url: auction.image_url || ''
                });
                setEditImagePreview(auction.image_url || '');
                setEditImageFile(null);
                setShowEditModal(true);
            };

            // 이미지 파일 선택 처리
            const handleEditImageChange = (e) => {
                const file = e.target.files[0];
                if (file) {
                    setEditImageFile(file);
                    const reader = new FileReader();
                    reader.onloadend = () => {
                        setEditImagePreview(reader.result);
                    };
                    reader.readAsDataURL(file);
                }
            };

            // 경매 수정 저장
            const handleSaveEdit = async () => {
                if (!editingAuction) return;
                setLoading(true);

                try {
                    const formData = new FormData();
                    formData.append('title', editForm.title);
                    formData.append('description', editForm.description);
                    formData.append('category', editForm.category);

                    if (editImageFile) {
                        formData.append('image', editImageFile);
                    } else if (editForm.image_url) {
                        formData.append('image_url', editForm.image_url);
                    }

                    const res = await fetch(`${API_BASE}/auctions/${editingAuction.id}`, {
                        method: 'PUT',
                        headers: {
                            'Authorization': `Bearer ${token}`
                        },
                        body: formData
                    });

                    if (res.ok) {
                        addToast('경매 정보가 수정되었습니다!', 'success');
                        setShowEditModal(false);
                        loadMyData();
                    } else {
                        const data = await res.json();
                        addToast(data.message || '수정 실패', 'error');
                    }
                } catch (error) {
                    console.error('수정 오류:', error);
                    addToast('수정 중 오류가 발생했습니다', 'error');
                }
                setLoading(false);
            };

            if (!user) {
                return (
                    <div className="main-container">
                        <div className="empty-state">
                            <i className="fas fa-user-lock"></i>
                            <h3>로그인이 필요합니다</h3>
                            <button className="btn btn-primary" onClick={() => setCurrentPage('login')}>
                                로그인하기
                            </button>
                        </div>
                    </div>
                );
            }

            return (
                <div className="main-container">
                    <div className="profile-header">
                        <div className="profile-avatar">
                            {(user.nickname || user.name || 'U')[0]}
                        </div>
                        <div className="profile-info">
                            <h2>{user.nickname || user.name}</h2>
                            <p style={{opacity: 0.8}}>{user.email}</p>
                            <div className="profile-stats">
                                <div className="profile-stat">
                                    <div className="profile-stat-value">{points.toLocaleString()}</div>
                                    <div className="profile-stat-label">보유 포인트</div>
                                </div>
                                <div className="profile-stat">
                                    <div className="profile-stat-value">{myBids.length}</div>
                                    <div className="profile-stat-label">입찰 참여</div>
                                </div>
                                <div className="profile-stat">
                                    <div className="profile-stat-value">{myAuctions.length}</div>
                                    <div className="profile-stat-label">등록 경매</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div className="tabs">
                        <button
                            className={`tab ${activeTab === 'bids' ? 'active' : ''}`}
                            onClick={() => setActiveTab('bids')}
                        >
                            <i className="fas fa-gavel"></i> 내 입찰
                        </button>
                        <button
                            className={`tab ${activeTab === 'auctions' ? 'active' : ''}`}
                            onClick={() => setActiveTab('auctions')}
                        >
                            <i className="fas fa-store"></i> 내 경매
                        </button>
                        <button
                            className={`tab ${activeTab === 'favorites' ? 'active' : ''}`}
                            onClick={() => setActiveTab('favorites')}
                        >
                            <i className="fas fa-heart"></i> 찜 목록
                        </button>
                        <button
                            className={`tab ${activeTab === 'points' ? 'active' : ''}`}
                            onClick={() => setActiveTab('points')}
                        >
                            <i className="fas fa-coins"></i> 포인트
                        </button>
                    </div>

                    <div style={{background: 'white', borderRadius: 4, padding: 24}}>
                        {activeTab === 'bids' && (
                            <div>
                                {myBids.map(bid => (
                                    <div key={bid.id} className="bid-item" style={{marginBottom: 15}}>
                                        <div className="bidder-info">
                                            <div className="bidder-avatar" style={{background: bid.is_highest ? 'var(--success)' : 'var(--gradient)'}}>
                                                {bid.is_highest ? <i className="fas fa-crown"></i> : bid.title[0]}
                                            </div>
                                            <div>
                                                <div style={{fontWeight: 600}}>{bid.title}</div>
                                                <div style={{color: 'var(--gray)', fontSize: '0.9rem'}}>
                                                    내 입찰: {bid.my_bid.toLocaleString()}원
                                                    {bid.is_highest && <span style={{color: 'var(--success)', marginLeft: 10}}>최고입찰자!</span>}
                                                </div>
                                            </div>
                                        </div>
                                        <div style={{textAlign: 'right'}}>
                                            <div className="bid-amount">{bid.current_price.toLocaleString()}원</div>
                                            <span style={{
                                                padding: '4px 12px',
                                                borderRadius: 4,
                                                fontSize: '0.8rem',
                                                background: bid.status === '진행중' ? 'var(--success)' : 'var(--gray)',
                                                color: 'white'
                                            }}>
                                                {bid.status}
                                            </span>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        )}

                        {activeTab === 'auctions' && (
                            <div>
                                {myAuctions.length > 0 ? myAuctions.map(auction => (
                                    <div key={auction.id} className="bid-item" style={{marginBottom: 15, alignItems: 'center'}}>
                                        <div className="bidder-info" style={{flex: 1}}>
                                            <div style={{
                                                width: 60,
                                                height: 60,
                                                borderRadius: 8,
                                                overflow: 'hidden',
                                                background: '#f0f0f0',
                                                display: 'flex',
                                                alignItems: 'center',
                                                justifyContent: 'center',
                                                marginRight: 12
                                            }}>
                                                {auction.image_url ? (
                                                    <img src={auction.image_url} alt={auction.title} style={{width: '100%', height: '100%', objectFit: 'cover'}} />
                                                ) : (
                                                    <i className="fas fa-image" style={{fontSize: '1.5rem', color: '#9ca3af'}}></i>
                                                )}
                                            </div>
                                            <div>
                                                <div style={{fontWeight: 600}}>{auction.title}</div>
                                                <div style={{color: 'var(--gray)', fontSize: '0.9rem'}}>
                                                    <i className="fas fa-gavel"></i> {auction.bid_count || 0}회 입찰
                                                </div>
                                            </div>
                                        </div>
                                        <div style={{display: 'flex', alignItems: 'center', gap: 16}}>
                                            <div style={{textAlign: 'right'}}>
                                                <div className="bid-amount">{(auction.current_price || 0).toLocaleString()}원</div>
                                                <span style={{
                                                    padding: '4px 12px',
                                                    borderRadius: 4,
                                                    fontSize: '0.8rem',
                                                    background: auction.status === '진행중' ? 'var(--success)' : 'var(--gray)',
                                                    color: 'white'
                                                }}>
                                                    {auction.status}
                                                </span>
                                            </div>
                                            <div style={{display: 'flex', gap: '8px'}}>
                                                <button
                                                    className="btn btn-outline btn-sm"
                                                    onClick={() => openEditModal(auction)}
                                                    style={{whiteSpace: 'nowrap'}}
                                                >
                                                    <i className="fas fa-edit"></i> 수정
                                                </button>
                                                <button
                                                    className="btn btn-sm"
                                                    onClick={() => handleDeleteAuction(auction.id)}
                                                    style={{whiteSpace: 'nowrap', background: 'var(--danger)', color: 'white', border: 'none'}}
                                                >
                                                    <i className="fas fa-trash"></i> 삭제
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                )) : (
                                    <div className="empty-state">
                                        <i className="fas fa-store"></i>
                                        <h3>등록한 경매가 없습니다</h3>
                                        <p>경매를 등록해보세요!</p>
                                        <button className="btn btn-primary" onClick={() => setCurrentPage('create')}>
                                            <i className="fas fa-plus"></i> 경매 등록하기
                                        </button>
                                    </div>
                                )}
                            </div>
                        )}

                        {activeTab === 'favorites' && (
                            <div className="auction-grid" style={{gridTemplateColumns: 'repeat(auto-fill, minmax(280px, 1fr))'}}>
                                {myFavorites.length > 0 ? myFavorites.map(auction => (
                                    <AuctionCard
                                        key={auction.id}
                                        auction={auction}
                                        onClick={() => {
                                            setSelectedAuction(auction);
                                            setCurrentPage('detail');
                                        }}
                                    />
                                )) : (
                                    <div className="empty-state" style={{gridColumn: '1 / -1'}}>
                                        <i className="fas fa-heart"></i>
                                        <h3>찜한 상품이 없습니다</h3>
                                        <p>관심있는 경매를 찜해보세요!</p>
                                    </div>
                                )}
                            </div>
                        )}

                        {activeTab === 'points' && (
                            <div>
                                <div className="points-summary">
                                    <div className="points-balance">
                                        <div className="points-icon"><i className="fas fa-coins"></i></div>
                                        <div className="points-info">
                                            <div className="points-label">보유 포인트</div>
                                            <div className="points-value">{points.toLocaleString()}P</div>
                                        </div>
                                        <button className="btn btn-primary" onClick={() => setShowChargeModal(true)}>
                                            <i className="fas fa-plus"></i> 충전하기
                                        </button>
                                    </div>
                                </div>

                                <div className="points-history-title">
                                    <i className="fas fa-history"></i> 포인트 내역
                                </div>
                                <div className="points-history-list">
                                    {pointHistory.length > 0 ? pointHistory.map((item, idx) => (
                                        <div key={idx} className="points-history-item">
                                            <div className="points-history-info">
                                                <div className="points-history-reason">{item.reason}</div>
                                                <div className="points-history-date">
                                                    {new Date(item.created_at).toLocaleString('ko-KR')}
                                                </div>
                                            </div>
                                            <div className={`points-history-amount ${item.amount > 0 ? 'plus' : 'minus'}`}>
                                                {item.amount > 0 ? '+' : ''}{item.amount.toLocaleString()}P
                                            </div>
                                        </div>
                                    )) : (
                                        <div style={{textAlign: 'center', padding: 40, color: '#9ca3af'}}>
                                            포인트 내역이 없습니다
                                        </div>
                                    )}
                                </div>
                            </div>
                        )}
                    </div>

                    {/* 경매 수정 모달 */}
                    {showEditModal && editingAuction && (
                        <div className="modal-overlay" onClick={() => setShowEditModal(false)}>
                            <div className="modal-content" onClick={(e) => e.stopPropagation()} style={{maxWidth: 550}}>
                                <div className="modal-header">
                                    <h3><i className="fas fa-edit"></i> 경매 정보 수정</h3>
                                    <button className="modal-close" onClick={() => setShowEditModal(false)}>
                                        <i className="fas fa-times"></i>
                                    </button>
                                </div>
                                <div className="modal-body">
                                    <div className="form-group">
                                        <label className="form-label">상품 이미지</label>
                                        <div style={{
                                            width: '100%',
                                            height: 200,
                                            border: '2px dashed #e5e5e5',
                                            borderRadius: 8,
                                            display: 'flex',
                                            flexDirection: 'column',
                                            alignItems: 'center',
                                            justifyContent: 'center',
                                            cursor: 'pointer',
                                            position: 'relative',
                                            overflow: 'hidden',
                                            background: '#fafafa'
                                        }} onClick={() => document.getElementById('editImageInput').click()}>
                                            {editImagePreview ? (
                                                <>
                                                    <img src={editImagePreview} alt="미리보기" style={{
                                                        width: '100%',
                                                        height: '100%',
                                                        objectFit: 'contain'
                                                    }} />
                                                    <div style={{
                                                        position: 'absolute',
                                                        bottom: 0,
                                                        left: 0,
                                                        right: 0,
                                                        background: 'rgba(0,0,0,0.7)',
                                                        color: 'white',
                                                        padding: '8px',
                                                        textAlign: 'center',
                                                        fontSize: '0.9rem'
                                                    }}>
                                                        <i className="fas fa-camera"></i> 클릭하여 이미지 변경
                                                    </div>
                                                </>
                                            ) : (
                                                <>
                                                    <i className="fas fa-cloud-upload-alt" style={{fontSize: '2.5rem', color: '#9ca3af', marginBottom: 10}}></i>
                                                    <span style={{color: '#6b7280'}}>클릭하여 이미지 업로드</span>
                                                </>
                                            )}
                                        </div>
                                        <input
                                            type="file"
                                            id="editImageInput"
                                            accept="image/*"
                                            style={{display: 'none'}}
                                            onChange={handleEditImageChange}
                                        />
                                        <div style={{marginTop: 10}}>
                                            <label className="form-label" style={{fontSize: '0.85rem'}}>또는 이미지 URL 직접 입력</label>
                                            <input
                                                type="url"
                                                className="form-input"
                                                placeholder="https://example.com/image.jpg"
                                                value={editForm.image_url}
                                                onChange={(e) => {
                                                    setEditForm({...editForm, image_url: e.target.value});
                                                    if (!editImageFile) {
                                                        setEditImagePreview(e.target.value);
                                                    }
                                                }}
                                            />
                                        </div>
                                    </div>

                                    <div className="form-group">
                                        <label className="form-label">상품명</label>
                                        <input
                                            type="text"
                                            className="form-input"
                                            value={editForm.title}
                                            onChange={(e) => setEditForm({...editForm, title: e.target.value})}
                                            placeholder="상품명을 입력하세요"
                                        />
                                    </div>

                                    <div className="form-group">
                                        <label className="form-label">카테고리</label>
                                        <select
                                            className="form-input"
                                            value={editForm.category}
                                            onChange={(e) => setEditForm({...editForm, category: e.target.value})}
                                        >
                                            <option value="전자기기">전자기기</option>
                                            <option value="게임">게임</option>
                                            <option value="가전">가전</option>
                                            <option value="스포츠">스포츠</option>
                                            <option value="도서">도서</option>
                                            <option value="패션">패션</option>
                                            <option value="기타">기타</option>
                                        </select>
                                    </div>

                                    <div className="form-group">
                                        <label className="form-label">상품 설명</label>
                                        <textarea
                                            className="form-input"
                                            rows="4"
                                            value={editForm.description}
                                            onChange={(e) => setEditForm({...editForm, description: e.target.value})}
                                            placeholder="상품에 대한 상세 설명을 입력하세요"
                                            style={{resize: 'vertical'}}
                                        ></textarea>
                                    </div>
                                </div>
                                <div className="modal-footer">
                                    <button className="btn btn-outline" onClick={() => setShowEditModal(false)}>취소</button>
                                    <button className="btn btn-primary" onClick={handleSaveEdit} disabled={loading}>
                                        {loading ? (
                                            <><i className="fas fa-spinner fa-spin"></i> 저장중...</>
                                        ) : (
                                            <><i className="fas fa-save"></i> 저장하기</>
                                        )}
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* 포인트 충전 모달 */}
                    {showChargeModal && (
                        <div className="modal-overlay" onClick={() => setShowChargeModal(false)}>
                            <div className="modal-content" onClick={(e) => e.stopPropagation()}>
                                <div className="modal-header">
                                    <h3><i className="fas fa-coins"></i> 포인트 충전</h3>
                                    <button className="modal-close" onClick={() => setShowChargeModal(false)}>
                                        <i className="fas fa-times"></i>
                                    </button>
                                </div>
                                <div className="modal-body">
                                    <div className="charge-current">
                                        현재 보유: <strong>{points.toLocaleString()}P</strong>
                                    </div>
                                    <div className="charge-options">
                                        {[10000, 30000, 50000, 100000].map(amount => (
                                            <button
                                                key={amount}
                                                className={`charge-option ${chargeAmount === amount ? 'active' : ''}`}
                                                onClick={() => setChargeAmount(amount)}
                                            >
                                                {amount.toLocaleString()}P
                                            </button>
                                        ))}
                                    </div>
                                    <div className="charge-custom">
                                        <label>직접 입력</label>
                                        <input
                                            type="number"
                                            className="form-input"
                                            value={chargeAmount}
                                            onChange={(e) => setChargeAmount(parseInt(e.target.value) || 0)}
                                            min="1000"
                                            step="1000"
                                        />
                                    </div>
                                    <div className="charge-result">
                                        충전 후 잔액: <strong>{(points + chargeAmount).toLocaleString()}P</strong>
                                    </div>
                                </div>
                                <div className="modal-footer">
                                    <button className="btn btn-outline" onClick={() => setShowChargeModal(false)}>취소</button>
                                    <button className="btn btn-primary" onClick={handleChargePoints} disabled={loading || chargeAmount < 1000}>
                                        {loading ? '처리중...' : `${chargeAmount.toLocaleString()}P 충전하기`}
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        // 로그인 페이지
        function LoginPage({ setCurrentPage }) {
            const { login, signup, demoLogin } = useContext(AuthContext);
            const { addToast } = useContext(ToastContext);
            const [isSignup, setIsSignup] = useState(false);
            const [formData, setFormData] = useState({
                email: '',
                password: '',
                name: '',
                nickname: ''
            });
            const [loading, setLoading] = useState(false);

            const handleSubmit = async (e) => {
                e.preventDefault();
                setLoading(true);

                if (isSignup) {
                    // 실제 회원가입 API 호출
                    const result = await signup(formData.email, formData.password, formData.name, formData.nickname);
                    if (result.success) {
                        addToast('회원가입 성공! 로그인해주세요.', 'success');
                        setIsSignup(false);
                        setFormData({ ...formData, name: '', nickname: '' });
                    } else {
                        addToast(result.message || '회원가입 실패', 'error');
                    }
                } else {
                    // 실제 로그인 API 호출
                    const result = await login(formData.email, formData.password);
                    if (result.success) {
                        addToast('로그인 성공!', 'success');
                        setCurrentPage('home');
                    } else {
                        addToast(result.message || '로그인 실패', 'error');
                    }
                }
                setLoading(false);
            };

            const handleChange = (e) => {
                setFormData({
                    ...formData,
                    [e.target.name]: e.target.value
                });
            };

            return (
                <div className="main-container" style={{display: 'flex', justifyContent: 'center', alignItems: 'center', minHeight: '70vh'}}>
                    <div style={{background: 'white', borderRadius: 8, padding: 50, width: '100%', maxWidth: 450, boxShadow: '0 10px 40px rgba(0,0,0,0.1)'}}>
                        <div style={{textAlign: 'center', marginBottom: 30}}>
                            <i className="fas fa-gavel" style={{fontSize: '3rem', color: 'var(--primary)'}}></i>
                            <h2 style={{marginTop: 15}}>{isSignup ? '회원가입' : '로그인'}</h2>
                            <p style={{color: 'var(--gray)'}}>BID달인에 오신 것을 환영합니다</p>
                        </div>

                        <form onSubmit={handleSubmit}>
                            {isSignup && (
                                <>
                                    <div className="form-group">
                                        <label className="form-label">이름</label>
                                        <input
                                            type="text"
                                            className="form-input"
                                            name="name"
                                            value={formData.name}
                                            onChange={handleChange}
                                            placeholder="홍길동"
                                            required
                                        />
                                    </div>
                                    <div className="form-group">
                                        <label className="form-label">닉네임</label>
                                        <input
                                            type="text"
                                            className="form-input"
                                            name="nickname"
                                            value={formData.nickname}
                                            onChange={handleChange}
                                            placeholder="입찰왕"
                                        />
                                    </div>
                                </>
                            )}
                            <div className="form-group">
                                <label className="form-label">이메일</label>
                                <input
                                    type="email"
                                    className="form-input"
                                    name="email"
                                    value={formData.email}
                                    onChange={handleChange}
                                    placeholder="example@email.com"
                                    required
                                />
                            </div>
                            <div className="form-group">
                                <label className="form-label">비밀번호</label>
                                <input
                                    type="password"
                                    className="form-input"
                                    name="password"
                                    value={formData.password}
                                    onChange={handleChange}
                                    placeholder="••••••••"
                                    required
                                />
                            </div>

                            <button
                                type="submit"
                                className="btn btn-primary btn-lg"
                                style={{width: '100%', marginTop: 10}}
                                disabled={loading}
                            >
                                {loading ? (
                                    <><i className="fas fa-spinner fa-spin"></i> 처리중...</>
                                ) : (
                                    isSignup ? '회원가입' : '로그인'
                                )}
                            </button>
                        </form>

                        <div style={{textAlign: 'center', marginTop: 20}}>
                            <span style={{color: 'var(--gray)'}}>
                                {isSignup ? '이미 계정이 있으신가요?' : '계정이 없으신가요?'}
                            </span>
                            <button
                                onClick={() => setIsSignup(!isSignup)}
                                style={{background: 'none', border: 'none', color: 'var(--primary)', fontWeight: 600, cursor: 'pointer', marginLeft: 8}}
                            >
                                {isSignup ? '로그인' : '회원가입'}
                            </button>
                        </div>

                        <div style={{borderTop: '1px solid #e5e7eb', marginTop: 25, paddingTop: 25}}>
                            <button
                                onClick={() => { demoLogin(); addToast('데모 계정으로 로그인!', 'success'); setCurrentPage('home'); }}
                                className="btn btn-outline"
                                style={{width: '100%'}}
                            >
                                <i className="fas fa-play"></i> 데모 계정으로 바로 시작
                            </button>
                        </div>
                    </div>
                </div>
            );
        }

        // 소리 알림 유틸리티
        const SoundUtils = {
            // Web Audio API를 사용한 알림음 생성
            playNotification: (type = 'message') => {
                try {
                    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();

                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);

                    if (type === 'message') {
                        // 메시지 알림음 (높은 톤)
                        oscillator.frequency.setValueAtTime(880, audioContext.currentTime);
                        oscillator.frequency.setValueAtTime(1100, audioContext.currentTime + 0.1);
                        gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
                        oscillator.start(audioContext.currentTime);
                        oscillator.stop(audioContext.currentTime + 0.3);
                    } else if (type === 'bid') {
                        // 입찰 알림음 (두 번 띵)
                        oscillator.frequency.setValueAtTime(660, audioContext.currentTime);
                        oscillator.frequency.setValueAtTime(880, audioContext.currentTime + 0.15);
                        gainNode.gain.setValueAtTime(0.4, audioContext.currentTime);
                        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.4);
                        oscillator.start(audioContext.currentTime);
                        oscillator.stop(audioContext.currentTime + 0.4);
                    } else if (type === 'success') {
                        // 성공 알림음
                        oscillator.frequency.setValueAtTime(523, audioContext.currentTime);
                        oscillator.frequency.setValueAtTime(659, audioContext.currentTime + 0.1);
                        oscillator.frequency.setValueAtTime(784, audioContext.currentTime + 0.2);
                        gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                        oscillator.start(audioContext.currentTime);
                        oscillator.stop(audioContext.currentTime + 0.5);
                    }
                } catch (e) {
                    console.log('소리 재생 실패:', e);
                }
            }
        };

        // 1:1 채팅 컴포넌트
        function PrivateChat() {
            const { user, token } = useContext(AuthContext);
            const { addToast } = useContext(ToastContext);
            const [isOpen, setIsOpen] = useState(false);
            const [chatRooms, setChatRooms] = useState([]);
            const [currentRoom, setCurrentRoom] = useState(null);
            const [messages, setMessages] = useState([]);
            const [newMessage, setNewMessage] = useState('');
            const [unreadCount, setUnreadCount] = useState(0);
            const [partnerTyping, setPartnerTyping] = useState(false);
            const [socket, setSocket] = useState(null);
            const messagesEndRef = useRef(null);
            const typingTimeoutRef = useRef(null);

            // Socket 연결
            useEffect(() => {
                if (!user || !token) return;

                const newSocket = io(API_BASE.replace('/api', '').replace('/auctions', ''), {
                    auth: { token },
                    transports: ['polling']  // App Engine Standard는 WebSocket 미지원
                });

                newSocket.on('connect', () => {
                    console.log('채팅 소켓 연결됨');
                });

                // 새 메시지 수신
                newSocket.on('private_message', (msg) => {
                    setMessages(prev => [...prev, msg]);
                    if (msg.senderId !== user.id) {
                        SoundUtils.playNotification('message');
                        setUnreadCount(prev => prev + 1);
                    }
                    scrollToBottom();
                });

                // 메시지 알림
                newSocket.on('new_message_notification', (data) => {
                    if (!isOpen) {
                        SoundUtils.playNotification('message');
                        addToast(`${data.senderNickname}: ${data.preview}`, 'info');
                        setUnreadCount(prev => prev + 1);
                    }
                });

                // 상대방 타이핑
                newSocket.on('partner_typing', (data) => {
                    setPartnerTyping(data.isTyping);
                });

                // 입찰 알림 (소리)
                newSocket.on('new_bid', (data) => {
                    if (data.userId !== user?.id) {
                        SoundUtils.playNotification('bid');
                    }
                });

                // 입찰 성공 알림 (소리)
                newSocket.on('bid_success', () => {
                    SoundUtils.playNotification('success');
                });

                setSocket(newSocket);

                return () => {
                    newSocket.disconnect();
                };
            }, [user, token]);

            // 메시지 스크롤
            const scrollToBottom = () => {
                setTimeout(() => {
                    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });
                }, 100);
            };

            // 채팅방 목록 로드
            const loadChatRooms = async () => {
                try {
                    const res = await fetch(`${API_BASE}/users/chat-rooms`, {
                        headers: { 'Authorization': `Bearer ${token}` }
                    });
                    if (res.ok) {
                        const data = await res.json();
                        setChatRooms(data.rooms || []);
                    }
                } catch (err) {
                    // 데모 데이터
                    setChatRooms([
                        { id: 1, auctionId: 22, auctionTitle: '아이폰 충전케이블', partnerName: '지훈', lastMessage: '안녕하세요! 상품 문의드립니다', time: '방금 전', unread: 2 },
                        { id: 2, auctionId: 23, auctionTitle: '포켓몬 카드 10장', partnerName: '민수', lastMessage: '네, 직거래 가능합니다', time: '5분 전', unread: 0 },
                    ]);
                }
            };

            // 채팅방 입장
            const enterRoom = (room) => {
                setCurrentRoom(room);
                setMessages([
                    { id: 1, senderId: room.partnerId || 2, senderNickname: room.partnerName, message: '안녕하세요! 상품에 대해 문의드립니다.', timestamp: new Date(Date.now() - 60000).toISOString() },
                    { id: 2, senderId: user?.id || 1, senderNickname: '나', message: '네, 안녕하세요! 무엇이 궁금하신가요?', timestamp: new Date(Date.now() - 30000).toISOString() },
                ]);

                if (socket) {
                    socket.emit('join_private_chat', {
                        auctionId: room.auctionId,
                        sellerId: room.sellerId || 1,
                        buyerId: user?.id || 1
                    });
                }

                setUnreadCount(prev => Math.max(0, prev - (room.unread || 0)));
                scrollToBottom();
            };

            // 메시지 전송
            const sendMessage = () => {
                if (!newMessage.trim() || !currentRoom) return;

                const msg = {
                    auctionId: currentRoom.auctionId,
                    receiverId: currentRoom.partnerId || 2,
                    message: newMessage.trim()
                };

                if (socket) {
                    socket.emit('send_private_message', msg);
                } else {
                    // 오프라인 모드
                    setMessages(prev => [...prev, {
                        id: Date.now(),
                        senderId: user?.id || 1,
                        senderNickname: user?.nickname || '나',
                        message: newMessage.trim(),
                        timestamp: new Date().toISOString()
                    }]);
                }

                setNewMessage('');
                scrollToBottom();
            };

            // 타이핑 표시
            const handleTyping = () => {
                if (socket && currentRoom) {
                    socket.emit('private_typing', {
                        auctionId: currentRoom.auctionId,
                        receiverId: currentRoom.partnerId,
                        isTyping: true
                    });

                    clearTimeout(typingTimeoutRef.current);
                    typingTimeoutRef.current = setTimeout(() => {
                        socket.emit('private_typing', {
                            auctionId: currentRoom.auctionId,
                            receiverId: currentRoom.partnerId,
                            isTyping: false
                        });
                    }, 2000);
                }
            };

            useEffect(() => {
                if (isOpen && !currentRoom) {
                    loadChatRooms();
                }
            }, [isOpen]);

            if (!user) return null;

            return (
                <>
                    {/* 채팅 FAB 버튼 */}
                    <button className="chat-fab" onClick={() => setIsOpen(!isOpen)}>
                        <i className={`fas ${isOpen ? 'fa-times' : 'fa-comments'}`}></i>
                        {unreadCount > 0 && !isOpen && (
                            <span className="badge">{unreadCount > 9 ? '9+' : unreadCount}</span>
                        )}
                    </button>

                    {/* 채팅 윈도우 */}
                    {isOpen && (
                        <div className="chat-window">
                            <div className="chat-header">
                                <div className="chat-header-title">
                                    {currentRoom && (
                                        <button className="chat-back-btn" onClick={() => setCurrentRoom(null)}>
                                            <i className="fas fa-arrow-left"></i>
                                        </button>
                                    )}
                                    <span className="online-dot"></span>
                                    <span>{currentRoom ? currentRoom.partnerName : '1:1 문의'}</span>
                                </div>
                                <button className="chat-close" onClick={() => setIsOpen(false)}>
                                    <i className="fas fa-times"></i>
                                </button>
                            </div>

                            {!currentRoom ? (
                                /* 채팅방 목록 */
                                <div className="chat-list">
                                    {chatRooms.length > 0 ? chatRooms.map(room => (
                                        <div
                                            key={room.id}
                                            className={`chat-room-item ${room.unread > 0 ? 'unread' : ''}`}
                                            onClick={() => enterRoom(room)}
                                        >
                                            <div className="chat-room-avatar">
                                                {room.partnerName[0]}
                                            </div>
                                            <div className="chat-room-info">
                                                <div className="chat-room-name">
                                                    {room.partnerName}
                                                    {room.unread > 0 && (
                                                        <span style={{
                                                            background: '#ef4444',
                                                            color: 'white',
                                                            fontSize: '0.7rem',
                                                            padding: '2px 6px',
                                                            borderRadius: '10px'
                                                        }}>{room.unread}</span>
                                                    )}
                                                </div>
                                                <div className="chat-room-preview">{room.auctionTitle}</div>
                                                <div className="chat-room-preview">{room.lastMessage}</div>
                                            </div>
                                            <div className="chat-room-time">{room.time}</div>
                                        </div>
                                    )) : (
                                        <div className="chat-empty">
                                            <i className="fas fa-comments"></i>
                                            <p>채팅 내역이 없습니다</p>
                                            <p style={{fontSize: '0.85rem', marginTop: 8}}>
                                                상품 상세페이지에서<br/>문의하기를 눌러보세요
                                            </p>
                                        </div>
                                    )}
                                </div>
                            ) : (
                                /* 채팅 메시지 */
                                <>
                                    <div className="chat-messages">
                                        {messages.map(msg => (
                                            <div
                                                key={msg.id}
                                                className={`chat-message ${msg.senderId === (user?.id || 1) ? 'sent' : 'received'}`}
                                            >
                                                <div>{msg.message}</div>
                                                <div className="chat-message-time">
                                                    {new Date(msg.timestamp).toLocaleTimeString('ko-KR', { hour: '2-digit', minute: '2-digit' })}
                                                </div>
                                            </div>
                                        ))}
                                        <div ref={messagesEndRef} />
                                    </div>
                                    {partnerTyping && (
                                        <div className="chat-typing">
                                            {currentRoom.partnerName}님이 입력 중...
                                        </div>
                                    )}
                                    <div className="chat-input-area">
                                        <input
                                            type="text"
                                            className="chat-input"
                                            placeholder="메시지를 입력하세요..."
                                            value={newMessage}
                                            onChange={(e) => { setNewMessage(e.target.value); handleTyping(); }}
                                            onKeyPress={(e) => e.key === 'Enter' && sendMessage()}
                                        />
                                        <button className="chat-send-btn" onClick={sendMessage}>
                                            <i className="fas fa-paper-plane"></i>
                                        </button>
                                    </div>
                                </>
                            )}
                        </div>
                    )}
                </>
            );
        }

        // 메인 App
        function App() {
            const [currentPage, setCurrentPage] = useState('home');
            const [selectedAuction, setSelectedAuction] = useState(null);
            const [filterCategory, setFilterCategory] = useState('전체');
            const [filterPrice, setFilterPrice] = useState({ min: '', max: '' });
            const [globalSearchKeyword, setGlobalSearchKeyword] = useState('');

            const renderPage = () => {
                switch (currentPage) {
                    case 'home':
                        return <HomePage setCurrentPage={setCurrentPage} setSelectedAuction={setSelectedAuction} setFilterCategory={setFilterCategory} setFilterPrice={setFilterPrice} />;
                    case 'auctions':
                        return <AuctionListPage setCurrentPage={setCurrentPage} setSelectedAuction={setSelectedAuction} filterCategory={filterCategory} setFilterCategory={setFilterCategory} filterPrice={filterPrice} setFilterPrice={setFilterPrice} globalSearchKeyword={globalSearchKeyword} setGlobalSearchKeyword={setGlobalSearchKeyword} />;
                    case 'detail':
                        return <AuctionDetailPage auction={selectedAuction} setCurrentPage={setCurrentPage} />;
                    case 'create':
                        return <CreateAuctionPage setCurrentPage={setCurrentPage} />;
                    case 'mypage':
                        return <MyPage setCurrentPage={setCurrentPage} setSelectedAuction={setSelectedAuction} />;
                    case 'login':
                        return <LoginPage setCurrentPage={setCurrentPage} />;
                    default:
                        return <HomePage setCurrentPage={setCurrentPage} setSelectedAuction={setSelectedAuction} setFilterCategory={setFilterCategory} setFilterPrice={setFilterPrice} />;
                }
            };

            return (
                <ToastProvider>
                    <AuthProvider>
                        <Header currentPage={currentPage} setCurrentPage={setCurrentPage} setGlobalSearchKeyword={setGlobalSearchKeyword} />
                        {renderPage()}
                        <PrivateChat />
                    </AuthProvider>
                </ToastProvider>
            );
        }

        // 렌더링
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
